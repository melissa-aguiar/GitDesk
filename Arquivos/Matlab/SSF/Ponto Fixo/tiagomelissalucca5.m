clc
clear all
clearvars 

load signal_var
load b48e7

totalJanelas = 1;
iterations = 500;
%[signalT, signalN] = signalGenerator(totalJanelas, bunch, fillAd, fillAe, detour, LUMEN, noise, matrix, exp_mean);
signalT = readtable('C:\Users\melis\Desktop\Ponto Fixo\signalT1.txt');
signalN = readtable('C:\Users\melis\Desktop\Ponto Fixo\signalN1.txt');
signalT = signalT.var1;
signalN = signalN.var1;
signalT = signalT';
signalN = signalN';

pass = 0;

Ad = length(fillAd);
Ae = length(fillAe);
Cd = length(fillCd);
Ce = length(fillCe);

toall = 2 * (Ce - Cd)-1;
mu = 0.25;
signalA = zeros(1, totalJanelas * window);
signalA2 = signalA;
signalA3 = signalA;
signalB = signalA;
signalxm = signalA;

signalW = zeros(1, bunch + 7);

B = ((H'*H)^-1*H');

ganho = 2^7;
xm = signalN(4:51)';
xm2 = xm;
xm3 = xm;
d1 = signalN(1:54)';    %d1 sem ganho (Tiago)
d2 = d1;                %d2 com ganho e truncado (Melissa)
d3 = d1;                %d3 simplificado (Lucca)

%%%%%%%%%%%%%%%%%%%%%%% MULTIPLIQUEI D PELO GANHO %%%%%%%%%%%%%%%%%%%%
for i=1:1:54
    d1(i)= d1(i)*ganho;
    d2(i) = d2(i)*ganho;
end
%%%%%%%%%%%%%%%%%%%%%%%% AGORA D1 e D2 TEM GANHO = ganho %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% D3 não tem ganho %%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%% ATUALIZEI D1 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%% MULTIPLIQUEI AS CONSTANTES PELO GANHO %%%%%%%%%%%%%%%%%
for m = 1:1:1
    d1(1) = 0.452445*ganho * d1(3) + 1.0*ganho * d1(4) + 0.563307*ganho * d1(5) + 0.149335*ganho * d1(6);
    d1(2) = 0.452445*ganho * d1(4) + 1.0*ganho * d1(5) + 0.563307*ganho * d1(6) + 0.149335*ganho * d1(7);
    d1(3) = 0.452445*ganho * d1(5) + 1.0*ganho * d1(6) + 0.563307*ganho * d1(7) + 0.149335*ganho * d1(8);
    d1(4) = 0.452445*ganho * d1(6) + 1.0*ganho * d1(7) + 0.563307*ganho * d1(8) + 0.149335*ganho * d1(9);
    d1(5) = 0.452445*ganho * d1(7) + 1.0*ganho * d1(8) + 0.563307*ganho * d1(9) + 0.149335*ganho * d1(10);
    d1(6) = 0.452445*ganho * d1(8) + 1.0*ganho * d1(9) + 0.563307*ganho * d1(10) + 0.149335*ganho * d1(11);
    d1(7) = 0.452445*ganho * d1(9) + 1.0*ganho * d1(10) + 0.563307*ganho * d1(11) + 0.149335*ganho * d1(12);
    d1(8) = 0.452445*ganho * d1(10) + 1.0*ganho * d1(11) + 0.563307*ganho * d1(12) + 0.149335*ganho * d1(13);
    d1(9) = 0.452445*ganho * d1(11) + 1.0*ganho * d1(12) + 0.563307*ganho * d1(13) + 0.149335*ganho * d1(14);
    d1(10) = 0.452445*ganho * d1(12) + 1.0*ganho * d1(13) + 0.563307*ganho * d1(14) + 0.149335*ganho * d1(15);
    d1(11) = 0.452445*ganho * d1(13) + 1.0*ganho * d1(14) + 0.563307*ganho * d1(15) + 0.149335*ganho * d1(16);
    d1(12) = 0.452445*ganho * d1(14) + 1.0*ganho * d1(15) + 0.563307*ganho * d1(16) + 0.149335*ganho * d1(17);
    d1(13) = 0.452445*ganho * d1(15) + 1.0*ganho * d1(16) + 0.563307*ganho * d1(17) + 0.149335*ganho * d1(18);
    d1(14) = 0.452445*ganho * d1(16) + 1.0*ganho * d1(17) + 0.563307*ganho * d1(18) + 0.149335*ganho * d1(19);
    d1(15) = 0.452445*ganho * d1(17) + 1.0*ganho * d1(18) + 0.563307*ganho * d1(19) + 0.149335*ganho * d1(20);
    d1(16) = 0.452445*ganho * d1(18) + 1.0*ganho * d1(19) + 0.563307*ganho * d1(20) + 0.149335*ganho * d1(21);
    d1(17) = 0.452445*ganho * d1(19) + 1.0*ganho * d1(20) + 0.563307*ganho * d1(21) + 0.149335*ganho * d1(22);
    d1(18) = 0.452445*ganho * d1(20) + 1.0*ganho * d1(21) + 0.563307*ganho * d1(22) + 0.149335*ganho * d1(23);
    d1(19) = 0.452445*ganho * d1(21) + 1.0*ganho * d1(22) + 0.563307*ganho * d1(23) + 0.149335*ganho * d1(24);
    d1(20) = 0.452445*ganho * d1(22) + 1.0*ganho * d1(23) + 0.563307*ganho * d1(24) + 0.149335*ganho * d1(25);
    d1(21) = 0.452445*ganho * d1(23) + 1.0*ganho * d1(24) + 0.563307*ganho * d1(25) + 0.149335*ganho * d1(26);
    d1(22) = 0.452445*ganho * d1(24) + 1.0*ganho * d1(25) + 0.563307*ganho * d1(26) + 0.149335*ganho * d1(27);
    d1(23) = 0.452445*ganho * d1(25) + 1.0*ganho * d1(26) + 0.563307*ganho * d1(27) + 0.149335*ganho * d1(28);
    d1(24) = 0.452445*ganho * d1(26) + 1.0*ganho * d1(27) + 0.563307*ganho * d1(28) + 0.149335*ganho * d1(29);
    d1(25) = 0.452445*ganho * d1(27) + 1.0*ganho * d1(28) + 0.563307*ganho * d1(29) + 0.149335*ganho * d1(30);
    d1(26) = 0.452445*ganho * d1(28) + 1.0*ganho * d1(29) + 0.563307*ganho * d1(30) + 0.149335*ganho * d1(31);
    d1(27) = 0.452445*ganho * d1(29) + 1.0*ganho * d1(30) + 0.563307*ganho * d1(31) + 0.149335*ganho * d1(32);
    d1(28) = 0.452445*ganho * d1(30) + 1.0*ganho * d1(31) + 0.563307*ganho * d1(32) + 0.149335*ganho * d1(33);
    d1(29) = 0.452445*ganho * d1(31) + 1.0*ganho * d1(32) + 0.563307*ganho * d1(33) + 0.149335*ganho * d1(34);
    d1(30) = 0.452445*ganho * d1(32) + 1.0*ganho * d1(33) + 0.563307*ganho * d1(34) + 0.149335*ganho * d1(35);
    d1(31) = 0.452445*ganho * d1(33) + 1.0*ganho * d1(34) + 0.563307*ganho * d1(35) + 0.149335*ganho * d1(36);
    d1(32) = 0.452445*ganho * d1(34) + 1.0*ganho * d1(35) + 0.563307*ganho * d1(36) + 0.149335*ganho * d1(37);
    d1(33) = 0.452445*ganho * d1(35) + 1.0*ganho * d1(36) + 0.563307*ganho * d1(37) + 0.149335*ganho * d1(38);
    d1(34) = 0.452445*ganho * d1(36) + 1.0*ganho * d1(37) + 0.563307*ganho * d1(38) + 0.149335*ganho * d1(39);
    d1(35) = 0.452445*ganho * d1(37) + 1.0*ganho * d1(38) + 0.563307*ganho * d1(39) + 0.149335*ganho * d1(40);
    d1(36) = 0.452445*ganho * d1(38) + 1.0*ganho * d1(39) + 0.563307*ganho * d1(40) + 0.149335*ganho * d1(41);
    d1(37) = 0.452445*ganho * d1(39) + 1.0*ganho * d1(40) + 0.563307*ganho * d1(41) + 0.149335*ganho * d1(42);
    d1(38) = 0.452445*ganho * d1(40) + 1.0*ganho * d1(41) + 0.563307*ganho * d1(42) + 0.149335*ganho * d1(43);
    d1(39) = 0.452445*ganho * d1(41) + 1.0*ganho * d1(42) + 0.563307*ganho * d1(43) + 0.149335*ganho * d1(44);
    d1(40) = 0.452445*ganho * d1(42) + 1.0*ganho * d1(43) + 0.563307*ganho * d1(44) + 0.149335*ganho * d1(45);
    d1(41) = 0.452445*ganho * d1(43) + 1.0*ganho * d1(44) + 0.563307*ganho * d1(45) + 0.149335*ganho * d1(46);
    d1(42) = 0.452445*ganho * d1(44) + 1.0*ganho * d1(45) + 0.563307*ganho * d1(46) + 0.149335*ganho * d1(47);
    d1(43) = 0.452445*ganho * d1(45) + 1.0*ganho * d1(46) + 0.563307*ganho * d1(47) + 0.149335*ganho * d1(48);
    d1(44) = 0.452445*ganho * d1(46) + 1.0*ganho * d1(47) + 0.563307*ganho * d1(48) + 0.149335*ganho * d1(49);
    d1(45) = 0.452445*ganho * d1(47) + 1.0*ganho * d1(48) + 0.563307*ganho * d1(49) + 0.149335*ganho * d1(50);
    d1(46) = 0.452445*ganho * d1(48) + 1.0*ganho * d1(49) + 0.563307*ganho * d1(50) + 0.149335*ganho * d1(51);
    d1(47) = 0.452445*ganho * d1(49) + 1.0*ganho * d1(50) + 0.563307*ganho * d1(51) + 0.149335*ganho * d1(52);
    d1(48) = 0.452445*ganho * d1(50) + 1.0*ganho * d1(51) + 0.563307*ganho * d1(52) + 0.149335*ganho * d1(53);
 
    d2(1) = fix(0.452445*ganho) * d2(3) + fix(1.0*ganho) * d2(4) + fix(0.563307*ganho) * d2(5) + fix(0.149335*ganho) * d2(6);
    d2(2) = fix(0.452445*ganho) * d2(4) + fix(1.0*ganho) * d2(5) + fix(0.563307*ganho) * d2(6) + fix(0.149335*ganho) * d2(7);
    d2(3) = fix(0.452445*ganho) * d2(5) + fix(1.0*ganho) * d2(6) + fix(0.563307*ganho) * d2(7) + fix(0.149335*ganho) * d2(8);
    d2(4) = fix(0.452445*ganho) * d2(6) + fix(1.0*ganho) * d2(7) + fix(0.563307*ganho) * d2(8) + fix(0.149335*ganho) * d2(9);
    d2(5) = fix(0.452445*ganho) * d2(7) + fix(1.0*ganho) * d2(8) + fix(0.563307*ganho) * d2(9) + fix(0.149335*ganho) * d2(10);
    d2(6) = fix(0.452445*ganho) * d2(8) + fix(1.0*ganho) * d2(9) + fix(0.563307*ganho) * d2(10) + fix(0.149335*ganho) * d2(11);
    d2(7) = fix(0.452445*ganho) * d2(9) + fix(1.0*ganho) * d2(10) + fix(0.563307*ganho) * d2(11) + fix(0.149335*ganho) * d2(12);
    d2(8) = fix(0.452445*ganho) * d2(10) + fix(1.0*ganho) * d2(11) + fix(0.563307*ganho) * d2(12) + fix(0.149335*ganho) * d2(13);
    d2(9) = fix(0.452445*ganho) * d2(11) + fix(1.0*ganho) * d2(12) + fix(0.563307*ganho) * d2(13) + fix(0.149335*ganho) * d2(14);
    d2(10) = fix(0.452445*ganho) * d2(12) + fix(1.0*ganho) * d2(13) + fix(0.563307*ganho) * d2(14) + fix(0.149335*ganho) * d2(15);
    d2(11) = fix(0.452445*ganho) * d2(13) + fix(1.0*ganho) * d2(14) + fix(0.563307*ganho) * d2(15) + fix(0.149335*ganho) * d2(16);
    d2(12) = fix(0.452445*ganho) * d2(14) + fix(1.0*ganho) * d2(15) + fix(0.563307*ganho) * d2(16) + fix(0.149335*ganho) * d2(17);
    d2(13) = fix(0.452445*ganho) * d2(15) + fix(1.0*ganho) * d2(16) + fix(0.563307*ganho) * d2(17) + fix(0.149335*ganho) * d2(18);
    d2(14) = fix(0.452445*ganho) * d2(16) + fix(1.0*ganho) * d2(17) + fix(0.563307*ganho) * d2(18) + fix(0.149335*ganho) * d2(19);
    d2(15) = fix(0.452445*ganho) * d2(17) + fix(1.0*ganho) * d2(18) + fix(0.563307*ganho) * d2(19) + fix(0.149335*ganho) * d2(20);
    d2(16) = fix(0.452445*ganho) * d2(18) + fix(1.0*ganho) * d2(19) + fix(0.563307*ganho) * d2(20) + fix(0.149335*ganho) * d2(21);
    d2(17) = fix(0.452445*ganho) * d2(19) + fix(1.0*ganho) * d2(20) + fix(0.563307*ganho) * d2(21) + fix(0.149335*ganho) * d2(22);
    d2(18) = fix(0.452445*ganho) * d2(20) + fix(1.0*ganho) * d2(21) + fix(0.563307*ganho) * d2(22) + fix(0.149335*ganho) * d2(23);
    d2(19) = fix(0.452445*ganho) * d2(21) + fix(1.0*ganho) * d2(22) + fix(0.563307*ganho) * d2(23) + fix(0.149335*ganho) * d2(24);
    d2(20) = fix(0.452445*ganho) * d2(22) + fix(1.0*ganho) * d2(23) + fix(0.563307*ganho) * d2(24) + fix(0.149335*ganho) * d2(25);
    d2(21) = fix(0.452445*ganho) * d2(23) + fix(1.0*ganho) * d2(24) + fix(0.563307*ganho) * d2(25) + fix(0.149335*ganho) * d2(26);
    d2(22) = fix(0.452445*ganho) * d2(24) + fix(1.0*ganho) * d2(25) + fix(0.563307*ganho) * d2(26) + fix(0.149335*ganho) * d2(27);
    d2(23) = fix(0.452445*ganho) * d2(25) + fix(1.0*ganho) * d2(26) + fix(0.563307*ganho) * d2(27) + fix(0.149335*ganho) * d2(28);
    d2(24) = fix(0.452445*ganho) * d2(26) + fix(1.0*ganho) * d2(27) + fix(0.563307*ganho) * d2(28) + fix(0.149335*ganho) * d2(29);
    d2(25) = fix(0.452445*ganho) * d2(27) + fix(1.0*ganho) * d2(28) + fix(0.563307*ganho) * d2(29) + fix(0.149335*ganho) * d2(30);
    d2(26) = fix(0.452445*ganho) * d2(28) + fix(1.0*ganho) * d2(29) + fix(0.563307*ganho) * d2(30) + fix(0.149335*ganho) * d2(31);
    d2(27) = fix(0.452445*ganho) * d2(29) + fix(1.0*ganho) * d2(30) + fix(0.563307*ganho) * d2(31) + fix(0.149335*ganho) * d2(32);
    d2(28) = fix(0.452445*ganho) * d2(30) + fix(1.0*ganho) * d2(31) + fix(0.563307*ganho) * d2(32) + fix(0.149335*ganho) * d2(33);
    d2(29) = fix(0.452445*ganho) * d2(31) + fix(1.0*ganho) * d2(32) + fix(0.563307*ganho) * d2(33) + fix(0.149335*ganho) * d2(34);
    d2(30) = fix(0.452445*ganho) * d2(32) + fix(1.0*ganho) * d2(33) + fix(0.563307*ganho) * d2(34) + fix(0.149335*ganho) * d2(35);
    d2(31) = fix(0.452445*ganho) * d2(33) + fix(1.0*ganho) * d2(34) + fix(0.563307*ganho) * d2(35) + fix(0.149335*ganho) * d2(36);
    d2(32) = fix(0.452445*ganho) * d2(34) + fix(1.0*ganho) * d2(35) + fix(0.563307*ganho) * d2(36) + fix(0.149335*ganho) * d2(37);
    d2(33) = fix(0.452445*ganho) * d2(35) + fix(1.0*ganho) * d2(36) + fix(0.563307*ganho) * d2(37) + fix(0.149335*ganho) * d2(38);
    d2(34) = fix(0.452445*ganho) * d2(36) + fix(1.0*ganho) * d2(37) + fix(0.563307*ganho) * d2(38) + fix(0.149335*ganho) * d2(39);
    d2(35) = fix(0.452445*ganho) * d2(37) + fix(1.0*ganho) * d2(38) + fix(0.563307*ganho) * d2(39) + fix(0.149335*ganho) * d2(40);
    d2(36) = fix(0.452445*ganho) * d2(38) + fix(1.0*ganho) * d2(39) + fix(0.563307*ganho) * d2(40) + fix(0.149335*ganho) * d2(41);
    d2(37) = fix(0.452445*ganho) * d2(39) + fix(1.0*ganho) * d2(40) + fix(0.563307*ganho) * d2(41) + fix(0.149335*ganho) * d2(42);
    d2(38) = fix(0.452445*ganho) * d2(40) + fix(1.0*ganho) * d2(41) + fix(0.563307*ganho) * d2(42) + fix(0.149335*ganho) * d2(43);
    d2(39) = fix(0.452445*ganho) * d2(41) + fix(1.0*ganho) * d2(42) + fix(0.563307*ganho) * d2(43) + fix(0.149335*ganho) * d2(44);
    d2(40) = fix(0.452445*ganho) * d2(42) + fix(1.0*ganho) * d2(43) + fix(0.563307*ganho) * d2(44) + fix(0.149335*ganho) * d2(45);
    d2(41) = fix(0.452445*ganho) * d2(43) + fix(1.0*ganho) * d2(44) + fix(0.563307*ganho) * d2(45) + fix(0.149335*ganho) * d2(46);
    d2(42) = fix(0.452445*ganho) * d2(44) + fix(1.0*ganho) * d2(45) + fix(0.563307*ganho) * d2(46) + fix(0.149335*ganho) * d2(47);
    d2(43) = fix(0.452445*ganho) * d2(45) + fix(1.0*ganho) * d2(46) + fix(0.563307*ganho) * d2(47) + fix(0.149335*ganho) * d2(48);
    d2(44) = fix(0.452445*ganho) * d2(46) + fix(1.0*ganho) * d2(47) + fix(0.563307*ganho) * d2(48) + fix(0.149335*ganho) * d2(49);
    d2(45) = fix(0.452445*ganho) * d2(47) + fix(1.0*ganho) * d2(48) + fix(0.563307*ganho) * d2(49) + fix(0.149335*ganho) * d2(50);
    d2(46) = fix(0.452445*ganho) * d2(48) + fix(1.0*ganho) * d2(49) + fix(0.563307*ganho) * d2(50) + fix(0.149335*ganho) * d2(51);
    d2(47) = fix(0.452445*ganho) * d2(49) + fix(1.0*ganho) * d2(50) + fix(0.563307*ganho) * d2(51) + fix(0.149335*ganho) * d2(52);
    d2(48) = fix(0.452445*ganho) * d2(50) + fix(1.0*ganho) * d2(51) + fix(0.563307*ganho) * d2(52) + fix(0.149335*ganho) * d2(53);

    d3(1) = 1897691 * d3(3) + 4194304 * d3(4) +  2362680 * d3(5) + 626356 * d3(6);
    d3(2) = 1897691 * d3(4) + 4194304 * d3(5) +  2362680 * d3(6) + 626356 * d3(7);
    d3(3) = 1897691 * d3(5) + 4194304 * d3(6) +  2362680 * d3(7) + 626356 * d3(8);
    d3(4) = 1897691 * d3(6) + 4194304 * d3(7) +  2362680 * d3(8) + 626356 * d3(9);
    d3(5) = 1897691 * d3(7) + 4194304 * d3(8) +  2362680 * d3(9) + 626356 * d3(10);
    d3(6) = 1897691 * d3(8) + 4194304 * d3(9) +  2362680 * d3(10) + 626356 * d3(11);
    d3(7) = 1897691 * d3(9) + 4194304 * d3(10) +  2362680 * d3(11) + 626356 * d3(12);
    d3(8) = 1897691 * d3(10) + 4194304 * d3(11) +  2362680 * d3(12) + 626356 * d3(13);
    d3(9) = 1897691 * d3(11) + 4194304 * d3(12) +  2362680 * d3(13) + 626356 * d3(14);
    d3(10) = 1897691 * d3(12) + 4194304 * d3(13) +  2362680 * d3(14) + 626356 * d3(15);
    d3(11) = 1897691 * d3(13) + 4194304 * d3(14) +  2362680 * d3(15) + 626356 * d3(16);
    d3(12) = 1897691 * d3(14) + 4194304 * d3(15) +  2362680 * d3(16) + 626356 * d3(17);
    d3(13) = 1897691 * d3(15) + 4194304 * d3(16) +  2362680 * d3(17) + 626356 * d3(18);
    d3(14) = 1897691 * d3(16) + 4194304 * d3(17) +  2362680 * d3(18) + 626356 * d3(19);
    d3(15) = 1897691 * d3(17) + 4194304 * d3(18) +  2362680 * d3(19) + 626356 * d3(20);
    d3(16) = 1897691 * d3(18) + 4194304 * d3(19) +  2362680 * d3(20) + 626356 * d3(21);
    d3(17) = 1897691 * d3(19) + 4194304 * d3(20) +  2362680 * d3(21) + 626356 * d3(22);
    d3(18) = 1897691 * d3(20) + 4194304 * d3(21) +  2362680 * d3(22) + 626356 * d3(23);
    d3(19) = 1897691 * d3(21) + 4194304 * d3(22) +  2362680 * d3(23) + 626356 * d3(24);
    d3(20) = 1897691 * d3(22) + 4194304 * d3(23) +  2362680 * d3(24) + 626356 * d3(25);
    d3(21) = 1897691 * d3(23) + 4194304 * d3(24) +  2362680 * d3(25) + 626356 * d3(26);
    d3(22) = 1897691 * d3(24) + 4194304 * d3(25) +  2362680 * d3(26) + 626356 * d3(27);
    d3(23) = 1897691 * d3(25) + 4194304 * d3(26) +  2362680 * d3(27) + 626356 * d3(28);
    d3(24) = 1897691 * d3(26) + 4194304 * d3(27) +  2362680 * d3(28) + 626356 * d3(29);
    d3(25) = 1897691 * d3(27) + 4194304 * d3(28) +  2362680 * d3(29) + 626356 * d3(30);
    d3(26) = 1897691 * d3(28) + 4194304 * d3(29) +  2362680 * d3(30) + 626356 * d3(31);
    d3(27) = 1897691 * d3(29) + 4194304 * d3(30) +  2362680 * d3(31) + 626356 * d3(32);
    d3(28) = 1897691 * d3(30) + 4194304 * d3(31) +  2362680 * d3(32) + 626356 * d3(33);
    d3(29) = 1897691 * d3(31) + 4194304 * d3(32) +  2362680 * d3(33) + 626356 * d3(34);
    d3(30) = 1897691 * d3(32) + 4194304 * d3(33) +  2362680 * d3(34) + 626356 * d3(35);
    d3(31) = 1897691 * d3(33) + 4194304 * d3(34) +  2362680 * d3(35) + 626356 * d3(36);
    d3(32) = 1897691 * d3(34) + 4194304 * d3(35) +  2362680 * d3(36) + 626356 * d3(37);
    d3(33) = 1897691 * d3(35) + 4194304 * d3(36) +  2362680 * d3(37) + 626356 * d3(38);
    d3(34) = 1897691 * d3(36) + 4194304 * d3(37) +  2362680 * d3(38) + 626356 * d3(39);
    d3(35) = 1897691 * d3(37) + 4194304 * d3(38) +  2362680 * d3(39) + 626356 * d3(40);
    d3(36) = 1897691 * d3(38) + 4194304 * d3(39) +  2362680 * d3(40) + 626356 * d3(41);
    d3(37) = 1897691 * d3(39) + 4194304 * d3(40) +  2362680 * d3(41) + 626356 * d3(42);
    d3(38) = 1897691 * d3(40) + 4194304 * d3(41) +  2362680 * d3(42) + 626356 * d3(43);
    d3(39) = 1897691 * d3(41) + 4194304 * d3(42) +  2362680 * d3(43) + 626356 * d3(44);
    d3(40) = 1897691 * d3(42) + 4194304 * d3(43) +  2362680 * d3(44) + 626356 * d3(45);
    d3(41) = 1897691 * d3(43) + 4194304 * d3(44) +  2362680 * d3(45) + 626356 * d3(46);
    d3(42) = 1897691 * d3(44) + 4194304 * d3(45) +  2362680 * d3(46) + 626356 * d3(47);
    d3(43) = 1897691 * d3(45) + 4194304 * d3(46) +  2362680 * d3(47) + 626356 * d3(48);
    d3(44) = 1897691 * d3(46) + 4194304 * d3(47) +  2362680 * d3(48) + 626356 * d3(49);
    d3(45) = 1897691 * d3(47) + 4194304 * d3(48) +  2362680 * d3(49) + 626356 * d3(50);
    d3(46) = 1897691 * d3(48) + 4194304 * d3(49) +  2362680 * d3(50) + 626356 * d3(51);
    d3(47) = 1897691 * d3(49) + 4194304 * d3(50) +  2362680 * d3(51) + 626356 * d3(52);
    d3(48) = 1897691 * d3(50) + 4194304 * d3(51) +  2362680 * d3(52) + 626356 * d3(53);
 
    
end


d1 = d1(1:48);
d2 = d2(1:48);
d3 = d3(1:48);
d2 = fix(d2);
%%%%%%%%%%%%%%%%%%%% AGORA D1, D2 e D3 TÊM GANHO = ganho^2 %%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%  MULTIPLIQUEI XM PELO GANHO %%%%%%%%%%%%%%%%%%%%
for i=1:1:48
    xm(i)= xm(i)*ganho;
    xm2(i)= xm2(i)*ganho;
%     xm2(i) = fix(xm2(i));
%     xm3(i) = xm3(i)*ganho;
end
%%%%%%%%%%%%%%%%%%%%%% AGORA XM TEM GANHO = ganho %%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%% ATUALIZEI AUX (QUE DEPENDE DE XM) %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%% MULTIPLIQUEI AS CONSTANTES PELO GANHO %%%%%%%%%%%%%%
for m = 1:1:1
        aux(1) = 0.871573739021862*ganho * xm(1) - 0.262603857539392*ganho * xm(2) - 0.180876530413027*ganho * xm(3) + 0.246857622347453*ganho * xm(4) - 0.201391040576744*ganho * xm(5) + 0.154613673410639*ganho * xm(6) - 0.115608532182600*ganho * xm(7);
        aux(2) = -0.581737655049595*ganho * xm(1) + 1.65460504745580*ganho * xm(2) - 0.935583159402059*ganho * xm(3) + 0.324698423782785*ganho * xm(4) - 0.118789823404043*ganho * xm(5);
        aux(3) = 0.351174142831637*ganho * xm(1) - 1.05442555166887*ganho * xm(2) + 2.06085849765563*ganho * xm(3) - 1.24078061333294*ganho * xm(4) + 0.545426663094391*ganho * xm(5) - 0.274343860369449*ganho * xm(6) + 0.163002195379183*ganho * xm(7);
        aux(4) = -0.210645314213160*ganho * xm(1) + 0.634707234719503*ganho * xm(2) - 1.29810916965253*ganho * xm(3) + 2.24392554542272*ganho * xm(4) - 1.37318036506467*ganho * xm(5) + 0.638732875019602*ganho * xm(6) - 0.338351963519939*ganho * xm(7) + 0.205982119362547*ganho * xm(8) - 0.122247502219380*ganho * xm(9);
        aux(5) = 0.126297789544157*ganho * xm(1) - 0.380644836404385*ganho * xm(2) + 0.780813984895368*ganho * xm(3) - 1.40787170369096*ganho * xm(4) + 2.32330920530794*ganho * xm(5) - 1.42912449257072*ganho * xm(6) + 0.677110571532902*ganho * xm(7) - 0.364121677003248*ganho * xm(8) + 0.223032326658700*ganho * xm(9) - 0.133404776006711*ganho * xm(10);
        aux(6) = 0.228222429616918*ganho * xm(2) - 0.468244364520262*ganho * xm(3) + 0.846623033245261*ganho * xm(4) - 1.45546684311940*ganho * xm(5) + 2.35685097640671*ganho * xm(6) - 1.45213416255990*ganho * xm(7) + 0.692561019497160*ganho * xm(8) - 0.374344271863671*ganho * xm(9) + 0.229721763783633*ganho * xm(10) - 0.137741850974191*ganho * xm(11);
        aux(7) = -0.136832554867872*ganho * xm(2) + 0.280743360433509*ganho * xm(3) - 0.507700655550944*ganho * xm(4) + 0.875159043414406*ganho * xm(5) - 1.47557705463805*ganho * xm(6) + 2.37064659051111*ganho * xm(7) - 1.46139759041242*ganho * xm(8) + 0.698690050200612*ganho * xm(9) - 0.378354972286345*ganho * xm(10) + 0.232322088456752*ganho * xm(11) - 0.139414494856972*ganho * xm(12);
        aux(8) = -0.168321854812225*ganho * xm(3) + 0.304399662095329*ganho * xm(4) - 0.524809624669736*ganho * xm(5) + 0.887216264651909*ganho * xm(6) - 1.48384831380456*ganho * xm(7) + 2.37620054497509*ganho * xm(8) - 1.46507229463393*ganho * xm(9) + 0.701094694342159*ganho * xm(10) - 0.379914015553698*ganho * xm(11) + 0.233324934067182*ganho * xm(12) - 0.140055311765331*ganho * xm(13);
        aux(9) = -0.182505159649342*ganho * xm(4) + 0.314657466883654*ganho * xm(5) - 0.532038617888744*ganho * xm(6) + 0.892175357236305*ganho * xm(7) - 1.48717822692201*ganho * xm(8) + 2.37840374017039*ganho * xm(9) - 1.46651401622558*ganho * xm(10) + 0.702029429882447*ganho * xm(11) - 0.380515278811183*ganho * xm(12) + 0.233709140427327*ganho* xm(13) - 0.140299452022049*ganho * xm(14);
        aux(10) = -0.188655299864276*ganho * xm(5) + 0.318991661463015*ganho * xm(6) - 0.535011877310447*ganho * xm(7) + 0.894171830458254*ganho * xm(8) - 1.48849916835651*ganho * xm(9) + 2.37926813466048*ganho * xm(10) - 1.46707444360309*ganho * xm(11) + 0.702389921568136*ganho * xm(12) - 0.380745632481886*ganho * xm(13) + 0.233855516464102*ganho * xm(14) - 0.140392018787635*ganho * xm(15);
        aux(11) = 0.113109640785164*ganho * xm(5) - 0.191253897218279*ganho * xm(6) + 0.320774300411157*ganho * xm(7) - 0.536208877107501*ganho * xm(8) + 0.894963810341399*ganho * xm(9) - 1.48901742225436*ganho * xm(10) + 2.37960414290231*ganho * xm(11) - 1.46729057897114*ganho * xm(12) + 0.702528031758674*ganho * xm(13) - 0.380833393281476*ganho * xm(14) + 0.233911015530358*ganho * xm(15) - 0.140426968477674*ganho * xm(16);
        aux(12) = 0.114667648411394*ganho * xm(6) - 0.192322691147336*ganho * xm(7) + 0.321491970199259*ganho * xm(8) - 0.536683714309912*ganho * xm(9) + 0.895274533171904*ganho * xm(10) - 1.48921887839855*ganho * xm(11) + 2.37973372840782*ganho * xm(12) - 1.46737338392351*ganho * xm(13) + 0.702580649373652*ganho * xm(14) - 0.380866668143530*ganho * xm(15) + 0.233931969866949*ganho * xm(16) - 0.140440115398638*ganho * xm(17);
        aux(13) = 0.115308451454539*ganho * xm(7) - 0.192752975200872*ganho * xm(8) + 0.321776662239541*ganho * xm(9) - 0.536870010404927*ganho * xm(10) + 0.895395317643773*ganho * xm(11) - 1.48929657231505*ganho * xm(12) + 2.37978337470915*ganho * xm(13) - 1.46740493119084*ganho * xm(14) + 0.702600599555140*ganho * xm(15) - 0.380879231465871*ganho * xm(16) + 0.233939852197422*ganho * xm(17) - 0.140445044678099*ganho * xm(18);
        aux(14) = 0.115566431335803*ganho * xm(8) - 0.192923664349457*ganho * xm(9) + 0.321888357395513*ganho * xm(10) - 0.536942427598767*ganho * xm(11) + 0.895441899586992*ganho * xm(12) - 1.48932633811002*ganho * xm(13) + 2.37980228909886*ganho * xm(14) - 1.46741689246481*ganho * xm(15) + 0.702608131984889*ganho * xm(16) - 0.380883957373470*ganho * xm(17) + 0.233942807582165*ganho * xm(18) - 0.140446887474426*ganho * xm(19);
        aux(15) = 0.115668769235446*ganho * xm(9) - 0.192990631978961*ganho * xm(10) + 0.321931775641942*ganho * xm(11) - 0.536970356135943*ganho * xm(12) + 0.895459745882237*ganho * xm(13) - 1.48933767836764*ganho * xm(14) + 2.37980946056621*ganho * xm(15) - 1.46742140858693*ganho * xm(16) + 0.702610965436579*ganho* xm(17) - 0.380885729295516*ganho * xm(18) + 0.233943912443858*ganho * xm(19) - 0.140447574601199*ganho * xm(20);
        aux(16) = 0.115708920156596*ganho * xm(10) - 0.193016663699086*ganho * xm(11) + 0.321948520396113*ganho * xm(12) - 0.536981056009865*ganho * xm(13) + 0.895466545014779*ganho * xm(14) - 1.48934197807217*ganho * xm(15) + 2.37981216823951*ganho * xm(16) - 1.46742310740314*ganho * xm(17) + 0.702612027805090*ganho * xm(18) - 0.380886391723205*ganho * xm(19) + 0.233944324415565*ganho * xm(20) - 0.140447830208941*ganho * xm(21);
        aux(17) = 0.115724527660556*ganho * xm(11) - 0.193026703136197*ganho * xm(12) + 0.321954935582044*ganho * xm(13) - 0.536985132478401*ganho * xm(14) + 0.895469122933367*ganho * xm(15) - 1.48934360147705*ganho * xm(16) + 2.37981318677690*ganho * xm(17) - 1.46742374435374*ganho * xm(18) + 0.702612424968282*ganho * xm(19) - 0.380886638723677*ganho * xm(20) + 0.233944477666831*ganho * xm(21) - 0.140447925091045*ganho * xm(22);
        aux(18) = 0.115730546876863*ganho * xm(12) - 0.193030549406791*ganho * xm(13) + 0.321957379657899*ganho * xm(14) - 0.536986678087916*ganho * xm(15) + 0.895470096257352*ganho * xm(16) - 1.48934421214838*ganho * xm(17) + 2.37981356866511*ganho * xm(18) - 1.46742398247565*ganho * xm(19) + 0.702612573058989*ganho * xm(20) - 0.380886730606254*ganho * xm(21) + 0.233944534553561*ganho * xm(22) - 0.140447960242363*ganho * xm(23);
        aux(19) = 0.115732852935885*ganho * xm(13) - 0.193032014769919*ganho * xm(14) + 0.321958306339094*ganho * xm(15) - 0.536987261651210*ganho * xm(16) + 0.895470462389629*ganho * xm(17) - 1.48934444111206*ganho * xm(18) + 2.37981371143260*ganho * xm(19) - 1.46742407126416*ganho * xm(20) + 0.702612628147298*ganho * xm(21) - 0.380886764712209*ganho * xm(22) + 0.233944555627336*ganho * xm(23) - 0.140447973239280*ganho * xm(24);
        aux(20) = 0.115733731504807*ganho * xm(14) - 0.193032570368220*ganho * xm(15) + 0.321958656218573*ganho * xm(16) - 0.536987481168315*ganho * xm(17) + 0.895470599666232*ganho * xm(18) - 1.48934452670898*ganho * xm(19) + 2.37981376466582*ganho * xm(20) - 1.46742410429181*ganho * xm(21) + 0.702612648594242*ganho * xm(22) - 0.380886777344655*ganho * xm(23) + 0.233944563415678*ganho * xm(24) - 0.140447978029393*ganho * xm(25);
        aux(21) = 0.115734064617654*ganho * xm(15) - 0.193032780140821*ganho * xm(16) + 0.321958787831393*ganho * xm(17) - 0.536987563473113*ganho * xm(18) + 0.895470650985876*ganho * xm(19) - 1.48934455862435*ganho * xm(20) + 2.37981378446617*ganho * xm(21) - 1.46742411654830*ganho * xm(22) + 0.702612656163830*ganho * xm(23) - 0.380886782007237*ganho * xm(24) + 0.233944566276281*ganho * xm(25) - 0.140447979770901*ganho * xm(26);
        aux(22) = 0.115734190388082*ganho * xm(16) - 0.193032859049845*ganho * xm(17) + 0.321958837177193*ganho * xm(18) - 0.536987594241138*ganho * xm(19) + 0.895470670119269*ganho * xm(20) - 1.48934457049303*ganho * xm(21) + 2.37981379181012*ganho * xm(22) - 1.46742412107933*ganho * xm(23) + 0.702612658947317*ganho * xm(24) - 0.380886783702820*ganho * xm(25) + 0.233944567288735*ganho * xm(26) - 0.140447980343665*ganho * xm(27);
        aux(23) = 0.115734237697887*ganho * xm(17) - 0.193032888634383*ganho * xm(18) + 0.321958855622600*ganho * xm(19) - 0.536987605709785*ganho * xm(20) + 0.895470677230455*ganho * xm(21) - 1.48934457488836*ganho * xm(22) + 2.37981379451405*ganho * xm(23) - 1.46742412272754*ganho * xm(24) + 0.702612659930348*ganho * xm(25) - 0.380886784255338*ganho * xm(26) + 0.233944567543781*ganho * xm(27) - 0.140447980363793*ganho * xm(28);
        aux(24) = 0.115734255433637*ganho * xm(18) - 0.193032899690394*ganho * xm(19) + 0.321958862493695*ganho * xm(20) - 0.536987609965156*ganho * xm(21) + 0.895470679852338*ganho * xm(22) - 1.48934457648772*ganho * xm(23) + 2.37981379546674*ganho * xm(24) - 1.46742412325918*ganho * xm(25) + 0.702612660167843*ganho * xm(26) - 0.380886784256238*ganho * xm(27) + 0.233944567309845*ganho * xm(28) - 0.140447979841923*ganho * xm(29);
        aux(25) = 0.115734262057070*ganho * xm(19) - 0.193032903801375*ganho * xm(20) + 0.321958865030927*ganho * xm(21) - 0.536987611514103*ganho * xm(22) + 0.895470680773718*ganho * xm(23) - 1.48934457699781*ganho * xm(24) + 2.37981379568613*ganho * xm(25) - 1.46742412324024*ganho * xm(26) + 0.702612659906845*ganho * xm(27) - 0.380886783692738*ganho * xm(28) + 0.233944566313347*ganho * xm(29) - 0.140447978183083*ganho * xm(30);
        aux(26) = 0.115734264507007*ganho * xm(20) - 0.193032905298352*ganho * xm(21) + 0.321958865920034*ganho * xm(22) - 0.536987612001982*ganho * xm(23) + 0.895470680974436*ganho * xm(24) - 1.48934457695842*ganho * xm(25) + 2.37981379539722*ganho * xm(26) - 1.46742412263380*ganho * xm(27) + 0.702612658840830*ganho * xm(28) - 0.380886781919169*ganho * xm(29) + 0.233944563423200*ganho * xm(30) - 0.140447973516594*ganho * xm(31);
        aux(27) = 0.115734265362800*ganho * xm(21) - 0.193032905763306*ganho * xm(22) + 0.321958866101493*ganho * xm(23) - 0.536987611941492*ganho * xm(24) + 0.895470680656748*ganho * xm(25) - 1.48934457630769*ganho * xm(26) + 2.37981379425950*ganho * xm(27) - 1.46742412074190*ganho * xm(28) + 0.702612655754035*ganho * xm(29) - 0.380886776925111*ganho * xm(30) + 0.233944555381462*ganho * xm(31) - 0.140447960612610*ganho * xm(32);
        aux(28) = 0.115734265524399*ganho * xm(22) - 0.193032905681055*ganho * xm(23) + 0.321958865754114*ganho * xm(24) - 0.536987611245083*ganho * xm(25) + 0.895470679445061*ganho * xm(26) - 1.48934457429371*ganho * xm(27) + 2.37981379096986*ganho * xm(28) - 1.46742411540994*ganho * xm(29) + 0.702612647148961*ganho * xm(30) - 0.380886763081694*ganho * xm(31) + 0.233944533175857*ganho * xm(32) - 0.140447925101420*ganho * xm(33);
        aux(29) = 0.115734265146378*ganho * xm(23) - 0.193032904937504*ganho * xm(24) + 0.321958864466108*ganho * xm(25) - 0.536987609105154*ganho * xm(26) + 0.895470675946129*ganho * xm(27) - 1.48934456861314*ganho * xm(28) + 2.37981378178361*ganho * xm(29) - 1.46742410059734*ganho * xm(30) + 0.702612623326969*ganho * xm(31) - 0.380886724874646*ganho * xm(32) + 0.233944472078051*ganho * xm(33) - 0.140447827719206*ganho * xm(34);
        aux(30) = 0.115734263779657*ganho * xm(24) - 0.193032902667665*ganho * xm(25) + 0.321958860751299*ganho * xm(26) - 0.536987603064998*ganho * xm(27) + 0.895470666160402*ganho * xm(28) - 1.48934455280083*ganho * xm(29) + 2.37981375629429*ganho * xm(30) - 1.46742405960945*ganho * xm(31) + 0.702612557591133*ganho * xm(32) - 0.380886619756618*ganho * xm(33) + 0.233944304534189*ganho * xm(34) - 0.140447561664206*ganho * xm(35);
        aux(31) = 0.115734259842288*ganho * xm(25) - 0.193032896256779*ganho * xm(26) + 0.321958850347505*ganho * xm(27) - 0.536987586221966*ganho * xm(28) + 0.895470638952017*ganho * xm(29) - 1.48934450894572*ganho * xm(30) + 2.37981368577623*ganho * xm(31) - 1.46742394651519*ganho * xm(32) + 0.702612376743383*ganho * xm(33) - 0.380886331510490*ganho * xm(34) + 0.233943846807720*ganho * xm(35) - 0.140446837860175*ganho * xm(36);
        aux(32) = 0.115734248801149*ganho * xm(26) - 0.193032878350870*ganho * xm(27) + 0.321958821366414*ganho * xm(28) - 0.536987539410151*ganho * xm(29) + 0.895470563502380*ganho * xm(30) - 1.48934438762601*ganho * xm(31) + 2.37981349120917*ganho * xm(32) - 1.46742363538584*ganho * xm(33) + 0.702611880846908*ganho * xm(34) - 0.380885544041535*ganho * xm(35) + 0.233942601581195*ganho * xm(36) - 0.140444878232668*ganho * xm(37);
        aux(33) = 0.115734217989030*ganho * xm(27) - 0.193032828485214*ganho * xm(28) + 0.321958740823419*ganho * xm(29) - 0.536987409595428*ganho * xm(30) + 0.895470354766986*ganho * xm(31) - 1.48934405286627*ganho * xm(32) + 2.37981295590014*ganho * xm(33) - 1.46742278217867*ganho * xm(34) + 0.702610525979272*ganho * xm(35) - 0.380883401586217*ganho * xm(36) + 0.233939229974326*ganho * xm(37) - 0.140439601840742*ganho * xm(38);
        aux(34) = 0.115734132182581*ganho * xm(28) - 0.193032689892278*ganho * xm(29) + 0.321958517448024*ganho * xm(30) - 0.536987050419896*ganho * xm(31) + 0.895469778739010*ganho * xm(32) - 1.48934313174920*ganho * xm(33) + 2.37981148776944*ganho * xm(34) - 1.46742045083082*ganho * xm(35) + 0.702606839413581*ganho * xm(36) - 0.380877599994911*ganho * xm(37) + 0.233930150781332*ganho * xm(38) - 0.140425487150932*ganho * xm(39);
        aux(35) = 0.115733893747997*ganho * xm(29) - 0.193032305598969*ganho * xm(30) + 0.321957899525561*ganho * xm(31) - 0.536986059426590*ganho * xm(32) + 0.895468194057690*ganho * xm(33) - 1.48934060599078*ganho * xm(34) + 2.37980747694030*ganho * xm(35) - 1.46741410849757*ganho * xm(36) + 0.702596858410010*ganho * xm(37) - 0.380861980235985*ganho * xm(38) + 0.233905868000671*ganho * xm(39) - 0.140388033766872*ganho * xm(40);
        aux(36) = 0.115733232925531*ganho * xm(30) - 0.193031243033079*ganho * xm(31) + 0.321956195435378*ganho * xm(32) - 0.536983334443697*ganho * xm(33) + 0.895463850819507*ganho * xm(34) - 1.48933370905796*ganho * xm(35) + 2.37979657080475*ganho * xm(36) - 1.46739694538526*ganho * xm(37) + 0.702569999019091*ganho * xm(38) - 0.380820224105089*ganho * xm(39) + 0.233841463992371*ganho * xm(40) - 0.140289613515372*ganho * xm(41);
        aux(37) = 0.115731405231445*ganho * xm(31) - 0.193028311868538*ganho * xm(32) + 0.321951508257898*ganho * xm(33) - 0.536975863744280*ganho * xm(34) + 0.895451987571451*ganho * xm(35) - 1.48931494967684*ganho * xm(36) + 2.37976704894860*ganho * xm(37) - 1.46735074519381*ganho * xm(38) + 0.702498175303985*ganho * xm(39) - 0.380709444321510*ganho * xm(40) + 0.233672173688111*ganho * xm(41) - 0.140033747849901*ganho * xm(42);
        aux(38) = 0.115726354828150*ganho * xm(32) - 0.193020235850905*ganho * xm(33) + 0.321938636225551*ganho * xm(34) - 0.536955423340508*ganho * xm(35) + 0.895419665114517*ganho * xm(36) - 1.48926408345062*ganho * xm(37) + 2.37968744591220*ganho * xm(38) - 1.46722699276705*ganho * xm(39) + 0.702307301481411*ganho * xm(40) - 0.380417756736869*ganho * xm(41) + 0.233231316556448*ganho * xm(42) - 0.139377198788325*ganho * xm(43);
        aux(39) = 0.115712436699182*ganho * xm(33) - 0.192998052317591*ganho * xm(34) + 0.321903409435730*ganho * xm(35) - 0.536899719137707*ganho * xm(36) + 0.895332002763000*ganho * xm(37) - 1.48912689636445*ganho * xm(38) + 2.37947417220304*ganho * xm(39) - 1.46689804270774*ganho * xm(40) + 0.701804609980931*ganho * xm(41) - 0.379657987913364*ganho * xm(42) + 0.232099826392710*ganho * xm(43) - 0.137727797293626*ganho * xm(44);
        aux(40) = 0.115674406044052*ganho * xm(34) - 0.192937660770588*ganho * xm(35) + 0.321807912145216*ganho * xm(36) - 0.536749433941464*ganho * xm(37) + 0.895096814135183*ganho * xm(38) - 1.48876126755486*ganho * xm(39) + 2.37891023200114*ganho * xm(40) - 1.46603624640083*ganho * xm(41) + 0.700502089517441*ganho * xm(42) - 0.377718201695619*ganho * xm(43) + 0.229272151535716*ganho * xm(44) - 0.133715380099537*ganho * xm(45);
        aux(41) = 0.115571319443436*ganho * xm(35) - 0.192774649694769*ganho * xm(36) + 0.321551379720183*ganho * xm(37) - 0.536347973847288*ganho * xm(38) + 0.894472696473965*ganho * xm(39) - 1.48779863815956*ganho * xm(40) + 2.37743917096490*ganho * xm(41) - 1.46381288214714*ganho * xm(42) + 0.697190931299798*ganho * xm(43) - 0.372891443595210*ganho * xm(44) + 0.222423072991240*ganho * xm(45) - 0.124245267258218*ganho * xm(46);
        aux(42) = 0.115289166532120*ganho * xm(36) - 0.192330622378187*ganho * xm(37) + 0.320856499732569*ganho * xm(38) - 0.535267699919742*ganho * xm(39) + 0.892806498732358*ganho * xm(40) - 1.48525240532238*ganho * xm(41) + 2.37359079014840*ganho * xm(42) - 1.45808165850978*ganho * xm(43) + 0.688836383344496*ganho * xm(44) - 0.361036497903068*ganho * xm(45) + 0.206031426625486*ganho * xm(46);
        aux(43) = 0.114503027930338*ganho * xm(37) - 0.191100355767390*ganho * xm(38) + 0.318943903360138*ganho * xm(39) - 0.532317740955530*ganho * xm(40) + 0.888298460943404*ganho * xm(41) - 1.47843894902971*ganho * xm(42) + 2.36344381051759*ganho * xm(43) - 1.44329015266548*ganho * xm(44) + 0.667847516032062*ganho * xm(45) - 0.332015522224442*ganho * xm(46) + 0.167401119112251*ganho * xm(47);
        aux(44) = 0.112385390826615*ganho * xm(38) - 0.187808235988512*ganho * xm(39) + 0.313866188901968*ganho * xm(40) - 0.524558131775665*ganho * xm(41) + 0.876570573895797*ganho * xm(42) - 1.46097312465619*ganho * xm(43) + 2.33798344174815*ganho * xm(44) - 1.40716237044693*ganho * xm(45) + 0.617894201568731*ganho * xm(46) - 0.265521827443356*ganho * xm(47);
        aux(45) = -0.179854564826454*ganho * xm(40) + 0.301711629942188*ganho * xm(41) - 0.506187709852394*ganho * xm(42) + 0.849212315611349*ganho * xm(43) - 1.42109230770101*ganho * xm(44) + 2.28139331602364*ganho * xm(45) - 1.32891609646490*ganho * xm(46) + 0.513739273796371*ganho * xm(47) - 0.144334490555431*ganho * xm(48);
        aux(46) = -0.160369402078658*ganho * xm(41) + 0.272261720479818*ganho * xm(42) - 0.462329259954492*ganho * xm(43) + 0.785278756898268*ganho * xm(44) - 1.33037179589068*ganho * xm(45) + 2.15595549569686*ganho * xm(46) - 1.16194370977899*ganho * xm(47) + 0.319461966816597*ganho * xm(48);
        aux(47) = 0.175187856762328*ganho * xm(43) - 0.320822262330650*ganho * xm(44) + 0.584483000998162*ganho * xm(45) - 1.05273467228582*ganho * xm(46) + 1.78638806348108*ganho * xm(47) - 0.731941079383758*ganho * xm(48);
        aux(48) = 0.127225939811203*ganho * xm(43) - 0.149028467369333*ganho * xm(44) + 0.139234575651491*ganho * xm(45) - 0.205993547085165*ganho * xm(47) + 0.801179737852662*ganho * xm(48);
        
        
        aux2(1) = fix(0.871573739021862*ganho) * xm2(1) - fix(0.262603857539392*ganho) * xm2(2) - fix(0.180876530413027*ganho) * xm2(3) + fix(0.246857622347453*ganho) * xm2(4) - fix(0.201391040576744*ganho) * xm2(5) + fix(0.154613673410639*ganho) * xm2(6) - fix(0.115608532182600*ganho) * xm2(7);
        aux2(2) = fix(-0.581737655049595*ganho) * xm2(1) + fix(1.65460504745580*ganho) * xm2(2) - fix(0.935583159402059*ganho) * xm2(3) + fix(0.324698423782785*ganho) * xm2(4)- fix(0.118789823404043*ganho) * xm2(5);
        aux2(3) = fix(0.351174142831637*ganho) * xm2(1) - fix(1.05442555166887*ganho) * xm2(2) + fix(2.06085849765563*ganho) * xm2(3) - fix(1.24078061333294*ganho) * xm2(4) + fix(0.545426663094391*ganho) * xm2(5) - fix(0.274343860369449*ganho) * xm2(6) + fix(0.163002195379183*ganho) * xm2(7);
        aux2(4) = fix(-0.210645314213160*ganho) * xm2(1) + fix(0.634707234719503*ganho) * xm2(2) - fix(1.29810916965253*ganho) * xm2(3) + fix(2.24392554542272*ganho) * xm2(4) - fix(1.37318036506467*ganho) * xm2(5) + fix(0.638732875019602*ganho) * xm2(6) - fix(0.338351963519939*ganho) * xm2(7) + fix(0.205982119362547*ganho) * xm2(8) - fix(0.122247502219380*ganho) * xm2(9);
        aux2(5) = fix(0.126297789544157*ganho) * xm2(1) - fix(0.380644836404385*ganho) * xm2(2) + fix(0.780813984895368*ganho) * xm2(3) - fix(1.40787170369096*ganho) * xm2(4) + fix(2.32330920530794*ganho) * xm2(5) - fix(1.42912449257072*ganho) * xm2(6) + fix(0.677110571532902*ganho) * xm2(7) - fix(0.364121677003248*ganho) * xm2(8) + fix(0.223032326658700*ganho) * xm2(9) - fix(0.133404776006711*ganho) * xm2(10);
        aux2(6) = fix(0.228222429616918*ganho) * xm2(2) - fix(0.468244364520262*ganho) * xm2(3) + fix(0.846623033245261*ganho) * xm2(4) - fix(1.45546684311940*ganho) * xm2(5) + fix(2.35685097640671*ganho) * xm2(6) - fix(1.45213416255990*ganho) * xm2(7) + fix(0.692561019497160*ganho) * xm2(8) - fix(0.374344271863671*ganho) * xm2(9) + fix(0.229721763783633*ganho) * xm2(10) - fix(0.137741850974191*ganho) * xm2(11);
        aux2(7) = fix(-0.136832554867872*ganho) * xm2(2) + fix(0.280743360433509*ganho) * xm2(3) - fix(0.507700655550944*ganho) * xm2(4) + fix(0.875159043414406*ganho) * xm2(5) - fix(1.47557705463805*ganho) * xm2(6) + fix(2.37064659051111*ganho) * xm2(7) - fix(1.46139759041242*ganho) * xm2(8) + fix(0.698690050200612*ganho) * xm2(9) - fix(0.378354972286345*ganho) * xm2(10) + fix(0.232322088456752*ganho) * xm2(11) - fix(0.139414494856972*ganho) * xm2(12);
        aux2(8) = fix(-0.168321854812225*ganho) * xm2(3) + fix(0.304399662095329*ganho) * xm2(4) - fix(0.524809624669736*ganho) * xm2(5) + fix(0.887216264651909*ganho) * xm2(6) - fix(1.48384831380456*ganho) * xm2(7) + fix(2.37620054497509*ganho) * xm2(8) - fix(1.46507229463393*ganho) * xm2(9) + fix(0.701094694342159*ganho) * xm2(10) - fix(0.379914015553698*ganho) * xm2(11) + fix(0.233324934067182*ganho) * xm2(12) - fix(0.140055311765331*ganho) * xm2(13);
        aux2(9) = fix(-0.182505159649342*ganho) * xm2(4) + fix(0.314657466883654*ganho) * xm2(5) - fix(0.532038617888744*ganho) * xm2(6) + fix(0.892175357236305*ganho) * xm2(7) - fix(1.48717822692201*ganho) * xm2(8) + fix(2.37840374017039*ganho) * xm2(9) - fix(1.46651401622558*ganho) * xm2(10) + fix(0.702029429882447*ganho) * xm2(11) - fix(0.380515278811183*ganho) * xm2(12) + fix(0.233709140427327*ganho)* xm2(13) - fix(0.140299452022049*ganho) * xm2(14);
        aux2(10) = fix(-0.188655299864276*ganho) * xm2(5) + fix(0.318991661463015*ganho) * xm2(6) - fix(0.535011877310447*ganho) * xm2(7) + fix(0.894171830458254*ganho) * xm2(8) - fix(1.48849916835651*ganho) * xm2(9) + fix(2.37926813466048*ganho) * xm2(10) - fix(1.46707444360309*ganho) * xm2(11) + fix(0.702389921568136*ganho) * xm2(12) - fix(0.380745632481886*ganho) * xm2(13) + fix(0.233855516464102*ganho) * xm2(14) - fix(0.140392018787635*ganho) * xm2(15);
        aux2(11) = fix(0.113109640785164*ganho) * xm2(5) - fix(0.191253897218279*ganho) * xm2(6) + fix(0.320774300411157*ganho) * xm2(7) - fix(0.536208877107501*ganho) * xm2(8) + fix(0.894963810341399*ganho) * xm2(9) - fix(1.48901742225436*ganho) * xm2(10) + fix(2.37960414290231*ganho) * xm2(11) - fix(1.46729057897114*ganho) * xm2(12) + fix(0.702528031758674*ganho) * xm2(13) - fix(0.380833393281476*ganho) * xm2(14) + fix(0.233911015530358*ganho) * xm2(15) - fix(0.140426968477674*ganho) * xm2(16);
        aux2(12) = fix(0.114667648411394*ganho) * xm2(6) - fix(0.192322691147336*ganho) * xm2(7) + fix(0.321491970199259*ganho) * xm2(8) - fix(0.536683714309912*ganho) * xm2(9) + fix(0.895274533171904*ganho) * xm2(10) - fix(1.48921887839855*ganho) * xm2(11) + fix(2.37973372840782*ganho) * xm2(12) - fix(1.46737338392351*ganho) * xm2(13) + fix(0.702580649373652*ganho) * xm2(14) - fix(0.380866668143530*ganho) * xm2(15) + fix(0.233931969866949*ganho) * xm2(16) - fix(0.140440115398638*ganho) * xm2(17);
        aux2(13) = fix(0.115308451454539*ganho) * xm2(7) - fix(0.192752975200872*ganho) * xm2(8) + fix(0.321776662239541*ganho) * xm2(9) - fix(0.536870010404927*ganho) * xm2(10) + fix(0.895395317643773*ganho) * xm2(11) - fix(1.48929657231505*ganho) * xm2(12) + fix(2.37978337470915*ganho) * xm2(13) - fix(1.46740493119084*ganho) * xm2(14) + fix(0.702600599555140*ganho) * xm2(15) - fix(0.380879231465871*ganho) * xm2(16) + fix(0.233939852197422*ganho) * xm2(17) - fix(0.140445044678099*ganho) * xm2(18);
        aux2(14) = fix(0.115566431335803*ganho) * xm2(8) - fix(0.192923664349457*ganho) * xm2(9) + fix(0.321888357395513*ganho) * xm2(10) - fix(0.536942427598767*ganho) * xm2(11) + fix(0.895441899586992*ganho) * xm2(12) - fix(1.48932633811002*ganho) * xm2(13) + fix(2.37980228909886*ganho) * xm2(14) - fix(1.46741689246481*ganho) * xm2(15) + fix(0.702608131984889*ganho) * xm2(16) - fix(0.380883957373470*ganho) * xm2(17) + fix(0.233942807582165*ganho) * xm2(18) - fix(0.140446887474426*ganho) * xm2(19);
        aux2(15) = fix(0.115668769235446*ganho) * xm2(9) - fix(0.192990631978961*ganho) * xm2(10) + fix(0.321931775641942*ganho) * xm2(11) - fix(0.536970356135943*ganho) * xm2(12) + fix(0.895459745882237*ganho) * xm2(13) - fix(1.48933767836764*ganho) * xm2(14) + fix(2.37980946056621*ganho) * xm2(15) - fix(1.46742140858693*ganho) * xm2(16) + fix(0.702610965436579*ganho)* xm2(17) - fix(0.380885729295516*ganho) * xm2(18) + fix(0.233943912443858*ganho) * xm2(19) - fix(0.140447574601199*ganho) * xm2(20);
        aux2(16) = fix(0.115708920156596*ganho) * xm2(10) - fix(0.193016663699086*ganho) * xm2(11) + fix(0.321948520396113*ganho) * xm2(12) - fix(0.536981056009865*ganho) * xm2(13) + fix(0.895466545014779*ganho) * xm2(14) - fix(1.48934197807217*ganho) * xm2(15) + fix(2.37981216823951*ganho) * xm2(16) - fix(1.46742310740314*ganho) * xm2(17) + fix(0.702612027805090*ganho) * xm2(18) - fix(0.380886391723205*ganho) * xm2(19) + fix(0.233944324415565*ganho) * xm2(20) - fix(0.140447830208941*ganho) * xm2(21);
        aux2(17) = fix(0.115724527660556*ganho) * xm2(11) - fix(0.193026703136197*ganho) * xm2(12) + fix(0.321954935582044*ganho) * xm2(13) - fix(0.536985132478401*ganho) * xm2(14) + fix(0.895469122933367*ganho) * xm2(15) - fix(1.48934360147705*ganho) * xm2(16) + fix(2.37981318677690*ganho) * xm2(17) - fix(1.46742374435374*ganho) * xm2(18) + fix(0.702612424968282*ganho) * xm2(19) - fix(0.380886638723677*ganho) * xm2(20) + fix(0.233944477666831*ganho) * xm2(21) - fix(0.140447925091045*ganho) * xm2(22);
        aux2(18) = fix(0.115730546876863*ganho) * xm2(12) - fix(0.193030549406791*ganho) * xm2(13) + fix(0.321957379657899*ganho) * xm2(14) - fix(0.536986678087916*ganho) * xm2(15) + fix(0.895470096257352*ganho) * xm2(16) - fix(1.48934421214838*ganho) * xm2(17) + fix(2.37981356866511*ganho) * xm2(18) - fix(1.46742398247565*ganho) * xm2(19) + fix(0.702612573058989*ganho) * xm2(20) - fix(0.380886730606254*ganho) * xm2(21) + fix(0.233944534553561*ganho) * xm2(22) - fix(0.140447960242363*ganho) * xm2(23);
        aux2(19) = fix(0.115732852935885*ganho) * xm2(13) - fix(0.193032014769919*ganho) * xm2(14) + fix(0.321958306339094*ganho) * xm2(15) - fix(0.536987261651210*ganho) * xm2(16) + fix(0.895470462389629*ganho) * xm2(17) - fix(1.48934444111206*ganho) * xm2(18) + fix(2.37981371143260*ganho) * xm2(19) - fix(1.46742407126416*ganho) * xm2(20) + fix(0.702612628147298*ganho) * xm2(21) - fix(0.380886764712209*ganho) * xm2(22) + fix(0.233944555627336*ganho) * xm2(23) - fix(0.140447973239280*ganho) * xm2(24);
        aux2(20) = fix(0.115733731504807*ganho) * xm2(14) - fix(0.193032570368220*ganho) * xm2(15) + fix(0.321958656218573*ganho) * xm2(16) - fix(0.536987481168315*ganho) * xm2(17) + fix(0.895470599666232*ganho) * xm2(18) - fix(1.48934452670898*ganho) * xm2(19) + fix(2.37981376466582*ganho) * xm2(20) - fix(1.46742410429181*ganho) * xm2(21) + fix(0.702612648594242*ganho) * xm2(22) - fix(0.380886777344655*ganho) * xm2(23) + fix(0.233944563415678*ganho) * xm2(24) - fix(0.140447978029393*ganho) * xm2(25);
        aux2(21) = fix(0.115734064617654*ganho) * xm2(15) - fix(0.193032780140821*ganho) * xm2(16) + fix(0.321958787831393*ganho) * xm2(17) - fix(0.536987563473113*ganho) * xm2(18) + fix(0.895470650985876*ganho) * xm2(19) - fix(1.48934455862435*ganho) * xm2(20) + fix(2.37981378446617*ganho) * xm2(21) - fix(1.46742411654830*ganho) * xm2(22) + fix(0.702612656163830*ganho) * xm2(23) - fix(0.380886782007237*ganho) * xm2(24) + fix(0.233944566276281*ganho) * xm2(25) - fix(0.140447979770901*ganho) * xm2(26);
        aux2(22) = fix(0.115734190388082*ganho) * xm2(16) - fix(0.193032859049845*ganho) * xm2(17) + fix(0.321958837177193*ganho) * xm2(18) - fix(0.536987594241138*ganho) * xm2(19) + fix(0.895470670119269*ganho) * xm2(20) - fix(1.48934457049303*ganho) * xm2(21) + fix(2.37981379181012*ganho) * xm2(22) - fix(1.46742412107933*ganho) * xm2(23) + fix(0.702612658947317*ganho) * xm2(24) - fix(0.380886783702820*ganho) * xm2(25) + fix(0.233944567288735*ganho) * xm2(26) - fix(0.140447980343665*ganho) * xm2(27);
        aux2(23) = fix(0.115734237697887*ganho) * xm2(17) - fix(0.193032888634383*ganho) * xm2(18) + fix(0.321958855622600*ganho) * xm2(19) - fix(0.536987605709785*ganho) * xm2(20) + fix(0.895470677230455*ganho) * xm2(21) - fix(1.48934457488836*ganho) * xm2(22) + fix(2.37981379451405*ganho) * xm2(23) - fix(1.46742412272754*ganho) * xm2(24) + fix(0.702612659930348*ganho) * xm2(25) - fix(0.380886784255338*ganho) * xm2(26) + fix(0.233944567543781*ganho) * xm2(27) - fix(0.140447980363793*ganho) * xm2(28);
        aux2(24) = fix(0.115734255433637*ganho) * xm2(18) - fix(0.193032899690394*ganho) * xm2(19) + fix(0.321958862493695*ganho) * xm2(20) - fix(0.536987609965156*ganho) * xm2(21) + fix(0.895470679852338*ganho) * xm2(22) - fix(1.48934457648772*ganho) * xm2(23) + fix(2.37981379546674*ganho) * xm2(24) - fix(1.46742412325918*ganho) * xm2(25) + fix(0.702612660167843*ganho) * xm2(26) - fix(0.380886784256238*ganho) * xm2(27) + fix(0.233944567309845*ganho) * xm2(28) - fix(0.140447979841923*ganho) * xm2(29);
        aux2(25) = fix(0.115734262057070*ganho) * xm2(19) - fix(0.193032903801375*ganho) * xm2(20) + fix(0.321958865030927*ganho) * xm2(21) - fix(0.536987611514103*ganho) * xm2(22) + fix(0.895470680773718*ganho) * xm2(23) - fix(1.48934457699781*ganho) * xm2(24) + fix(2.37981379568613*ganho) * xm2(25) - fix(1.46742412324024*ganho) * xm2(26) + fix(0.702612659906845*ganho) * xm2(27) - fix(0.380886783692738*ganho) * xm2(28) + fix(0.233944566313347*ganho) * xm2(29) - fix(0.140447978183083*ganho) * xm2(30);
        aux2(26) = fix(0.115734264507007*ganho) * xm2(20) - fix(0.193032905298352*ganho) * xm2(21) + fix(0.321958865920034*ganho) * xm2(22) - fix(0.536987612001982*ganho) * xm2(23) + fix(0.895470680974436*ganho) * xm2(24) - fix(1.48934457695842*ganho) * xm2(25) + fix(2.37981379539722*ganho) * xm2(26) - fix(1.46742412263380*ganho) * xm2(27) + fix(0.702612658840830*ganho) * xm2(28) - fix(0.380886781919169*ganho) * xm2(29) + fix(0.233944563423200*ganho) * xm2(30) - fix(0.140447973516594*ganho) * xm2(31);
        aux2(27) = fix(0.115734265362800*ganho) * xm2(21) - fix(0.193032905763306*ganho) * xm2(22) + fix(0.321958866101493*ganho) * xm2(23) - fix(0.536987611941492*ganho) * xm2(24) + fix(0.895470680656748*ganho) * xm2(25) - fix(1.48934457630769*ganho) * xm2(26) + fix(2.37981379425950*ganho) * xm2(27) - fix(1.46742412074190*ganho) * xm2(28) + fix(0.702612655754035*ganho) * xm2(29) - fix(0.380886776925111*ganho) * xm2(30) + fix(0.233944555381462*ganho) * xm2(31) - fix(0.140447960612610*ganho) * xm2(32);
        aux2(28) = fix(0.115734265524399*ganho) * xm2(22) - fix(0.193032905681055*ganho) * xm2(23) + fix(0.321958865754114*ganho) * xm2(24) - fix(0.536987611245083*ganho) * xm2(25) + fix(0.895470679445061*ganho) * xm2(26) - fix(1.48934457429371*ganho) * xm2(27) + fix(2.37981379096986*ganho) * xm2(28) - fix(1.46742411540994*ganho) * xm2(29) + fix(0.702612647148961*ganho) * xm2(30) - fix(0.380886763081694*ganho) * xm2(31) + fix(0.233944533175857*ganho) * xm2(32) - fix(0.140447925101420*ganho) * xm2(33);
        aux2(29) = fix(0.115734265146378*ganho) * xm2(23) - fix(0.193032904937504*ganho) * xm2(24) + fix(0.321958864466108*ganho) * xm2(25) - fix(0.536987609105154*ganho) * xm2(26) + fix(0.895470675946129*ganho) * xm2(27) - fix(1.48934456861314*ganho) * xm2(28) + fix(2.37981378178361*ganho) * xm2(29) - fix(1.46742410059734*ganho) * xm2(30) + fix(0.702612623326969*ganho) * xm2(31) - fix(0.380886724874646*ganho) * xm2(32) + fix(0.233944472078051*ganho) * xm2(33) - fix(0.140447827719206*ganho) * xm2(34);
        aux2(30) = fix(0.115734263779657*ganho) * xm2(24) - fix(0.193032902667665*ganho) * xm2(25) + fix(0.321958860751299*ganho) * xm2(26) - fix(0.536987603064998*ganho) * xm2(27) + fix(0.895470666160402*ganho) * xm2(28) - fix(1.48934455280083*ganho) * xm2(29) + fix(2.37981375629429*ganho) * xm2(30) - fix(1.46742405960945*ganho) * xm2(31) + fix(0.702612557591133*ganho) * xm2(32) - fix(0.380886619756618*ganho) * xm2(33) + fix(0.233944304534189*ganho) * xm2(34) - fix(0.140447561664206*ganho) * xm2(35);
        aux2(31) = fix(0.115734259842288*ganho) * xm2(25) - fix(0.193032896256779*ganho) * xm2(26) + fix(0.321958850347505*ganho) * xm2(27) - fix(0.536987586221966*ganho) * xm2(28) + fix(0.895470638952017*ganho) * xm2(29) - fix(1.48934450894572*ganho) * xm2(30) + fix(2.37981368577623*ganho) * xm2(31) - fix(1.46742394651519*ganho) * xm2(32) + fix(0.702612376743383*ganho) * xm2(33) - fix(0.380886331510490*ganho) * xm2(34) + fix(0.233943846807720*ganho) * xm2(35) - fix(0.140446837860175*ganho) * xm2(36);
        aux2(32) = fix(0.115734248801149*ganho) * xm2(26) - fix(0.193032878350870*ganho) * xm2(27) + fix(0.321958821366414*ganho) * xm2(28) - fix(0.536987539410151*ganho) * xm2(29) + fix(0.895470563502380*ganho) * xm2(30) - fix(1.48934438762601*ganho) * xm2(31) + fix(2.37981349120917*ganho) * xm2(32) - fix(1.46742363538584*ganho) * xm2(33) + fix(0.702611880846908*ganho) * xm2(34) - fix(0.380885544041535*ganho) * xm2(35) + fix(0.233942601581195*ganho) * xm2(36) - fix(0.140444878232668*ganho) * xm2(37);
        aux2(33) = fix(0.115734217989030*ganho) * xm2(27) - fix(0.193032828485214*ganho) * xm2(28) + fix(0.321958740823419*ganho) * xm2(29) - fix(0.536987409595428*ganho) * xm2(30) + fix(0.895470354766986*ganho) * xm2(31) - fix(1.48934405286627*ganho) * xm2(32) + fix(2.37981295590014*ganho) * xm2(33) - fix(1.46742278217867*ganho) * xm2(34) + fix(0.702610525979272*ganho) * xm2(35) - fix(0.380883401586217*ganho) * xm2(36) + fix(0.233939229974326*ganho) * xm2(37) - fix(0.140439601840742*ganho) * xm2(38);
        aux2(34) = fix(0.115734132182581*ganho) * xm2(28) - fix(0.193032689892278*ganho) * xm2(29) + fix(0.321958517448024*ganho) * xm2(30) - fix(0.536987050419896*ganho) * xm2(31) + fix(0.895469778739010*ganho) * xm2(32) - fix(1.48934313174920*ganho) * xm2(33) + fix(2.37981148776944*ganho) * xm2(34) - fix(1.46742045083082*ganho) * xm2(35) + fix(0.702606839413581*ganho) * xm2(36) - fix(0.380877599994911*ganho) * xm2(37) + fix(0.233930150781332*ganho) * xm2(38) - fix(0.140425487150932*ganho) * xm2(39);
        aux2(35) = fix(0.115733893747997*ganho) * xm2(29) - fix(0.193032305598969*ganho) * xm2(30) + fix(0.321957899525561*ganho) * xm2(31) - fix(0.536986059426590*ganho) * xm2(32) + fix(0.895468194057690*ganho) * xm2(33) - fix(1.48934060599078*ganho) * xm2(34) + fix(2.37980747694030*ganho) * xm2(35) - fix(1.46741410849757*ganho) * xm2(36) + fix(0.702596858410010*ganho) * xm2(37) - fix(0.380861980235985*ganho) * xm2(38) + fix(0.233905868000671*ganho) * xm2(39) - fix(0.140388033766872*ganho) * xm2(40);
        aux2(36) = fix(0.115733232925531*ganho) * xm2(30) - fix(0.193031243033079*ganho) * xm2(31) + fix(0.321956195435378*ganho) * xm2(32) - fix(0.536983334443697*ganho) * xm2(33) + fix(0.895463850819507*ganho) * xm2(34) - fix(1.48933370905796*ganho) * xm2(35) + fix(2.37979657080475*ganho) * xm2(36) - fix(1.46739694538526*ganho) * xm2(37) + fix(0.702569999019091*ganho) * xm2(38) - fix(0.380820224105089*ganho) * xm2(39) + fix(0.233841463992371*ganho) * xm2(40) - fix(0.140289613515372*ganho) * xm2(41);
        aux2(37) = fix(0.115731405231445*ganho) * xm2(31) - fix(0.193028311868538*ganho) * xm2(32) + fix(0.321951508257898*ganho) * xm2(33) - fix(0.536975863744280*ganho) * xm2(34) + fix(0.895451987571451*ganho) * xm2(35) - fix(1.48931494967684*ganho) * xm2(36) + fix(2.37976704894860*ganho) * xm2(37) - fix(1.46735074519381*ganho) * xm2(38) + fix(0.702498175303985*ganho) * xm2(39) - fix(0.380709444321510*ganho) * xm2(40) + fix(0.233672173688111*ganho) * xm2(41) - fix(0.140033747849901*ganho) * xm2(42);
        aux2(38) = fix(0.115726354828150*ganho) * xm2(32) - fix(0.193020235850905*ganho) * xm2(33) + fix(0.321938636225551*ganho) * xm2(34) - fix(0.536955423340508*ganho) * xm2(35) + fix(0.895419665114517*ganho) * xm2(36) - fix(1.48926408345062*ganho) * xm2(37) + fix(2.37968744591220*ganho) * xm2(38) - fix(1.46722699276705*ganho) * xm2(39) + fix(0.702307301481411*ganho) * xm2(40) - fix(0.380417756736869*ganho) * xm2(41) + fix(0.233231316556448*ganho) * xm2(42) - fix(0.139377198788325*ganho) * xm2(43);
        aux2(39) = fix(0.115712436699182*ganho) * xm2(33) - fix(0.192998052317591*ganho) * xm2(34) + fix(0.321903409435730*ganho) * xm2(35) - fix(0.536899719137707*ganho) * xm2(36) + fix(0.895332002763000*ganho) * xm2(37) - fix(1.48912689636445*ganho) * xm2(38) + fix(2.37947417220304*ganho) * xm2(39) - fix(1.46689804270774*ganho) * xm2(40) + fix(0.701804609980931*ganho) * xm2(41) - fix(0.379657987913364*ganho) * xm2(42) + fix(0.232099826392710*ganho) * xm2(43) - fix(0.137727797293626*ganho) * xm2(44);
        aux2(40) = fix(0.115674406044052*ganho) * xm2(34) - fix(0.192937660770588*ganho) * xm2(35) + fix(0.321807912145216*ganho) * xm2(36) - fix(0.536749433941464*ganho) * xm2(37) + fix(0.895096814135183*ganho) * xm2(38) - fix(1.48876126755486*ganho) * xm2(39) + fix(2.37891023200114*ganho) * xm2(40) - fix(1.46603624640083*ganho) * xm2(41) + fix(0.700502089517441*ganho) * xm2(42) - fix(0.377718201695619*ganho) * xm2(43) + fix(0.229272151535716*ganho) * xm2(44) - fix(0.133715380099537*ganho) * xm2(45);
        aux2(41) = fix(0.115571319443436*ganho) * xm2(35) - fix(0.192774649694769*ganho) * xm2(36) + fix(0.321551379720183*ganho) * xm2(37) - fix(0.536347973847288*ganho) * xm2(38) + fix(0.894472696473965*ganho) * xm2(39) - fix(1.48779863815956*ganho) * xm2(40) + fix(2.37743917096490*ganho) * xm2(41) - fix(1.46381288214714*ganho) * xm2(42) + fix(0.697190931299798*ganho) * xm2(43) - fix(0.372891443595210*ganho) * xm2(44) + fix(0.222423072991240*ganho) * xm2(45) - fix(0.124245267258218*ganho) * xm2(46);
        aux2(42) = fix(0.115289166532120*ganho) * xm2(36) - fix(0.192330622378187*ganho) * xm2(37) + fix(0.320856499732569*ganho) * xm2(38) - fix(0.535267699919742*ganho) * xm2(39) + fix(0.892806498732358*ganho) * xm2(40) - fix(1.48525240532238*ganho) * xm2(41) + fix(2.37359079014840*ganho) * xm2(42) - fix(1.45808165850978*ganho) * xm2(43) + fix(0.688836383344496*ganho) * xm2(44) - fix(0.361036497903068*ganho) * xm2(45)+ fix(0.206031426625486*ganho) * xm2(46);
        aux2(43) = fix(0.114503027930338*ganho) * xm2(37) - fix(0.191100355767390*ganho) * xm2(38) + fix(0.318943903360138*ganho) * xm2(39) - fix(0.532317740955530*ganho) * xm2(40) + fix(0.888298460943404*ganho) * xm2(41) - fix(1.47843894902971*ganho) * xm2(42) + fix(2.36344381051759*ganho) * xm2(43) - fix(1.44329015266548*ganho) * xm2(44) + fix(0.667847516032062*ganho) * xm2(45) - fix(0.332015522224442*ganho) * xm2(46) + fix(0.167401119112251*ganho) * xm2(47);
        aux2(44) = fix(0.112385390826615*ganho) * xm2(38) - fix(0.187808235988512*ganho) * xm2(39) + fix(0.313866188901968*ganho) * xm2(40) - fix(0.524558131775665*ganho) * xm2(41) + fix(0.876570573895797*ganho) * xm2(42) - fix(1.46097312465619*ganho) * xm2(43) + fix(2.33798344174815*ganho) * xm2(44) - fix(1.40716237044693*ganho) * xm2(45) + fix(0.617894201568731*ganho) * xm2(46) - fix(0.265521827443356*ganho) * xm2(47);
        aux2(45) = fix(-0.179854564826454*ganho) * xm2(40) + fix(0.301711629942188*ganho) * xm2(41) - fix(0.506187709852394*ganho) * xm2(42) + fix(0.849212315611349*ganho) * xm2(43) - fix(1.42109230770101*ganho) * xm2(44) + fix(2.28139331602364*ganho) * xm2(45) - fix(1.32891609646490*ganho) * xm2(46) + fix(0.513739273796371*ganho) * xm2(47) - fix(0.144334490555431*ganho) * xm2(48);
        aux2(46) = fix(-0.160369402078658*ganho) * xm2(41) + fix(0.272261720479818*ganho) * xm2(42) - fix(0.462329259954492*ganho) * xm2(43) + fix(0.785278756898268*ganho) * xm2(44) - fix(1.33037179589068*ganho) * xm2(45) + fix(2.15595549569686*ganho) * xm2(46) - fix(1.16194370977899*ganho) * xm2(47) + fix(0.319461966816597*ganho) * xm2(48);
        aux2(47) = fix(0.175187856762328*ganho) * xm2(43) - fix(0.320822262330650*ganho) * xm2(44) + fix(0.584483000998162*ganho) * xm2(45) - fix(1.05273467228582*ganho) * xm2(46) + fix(1.78638806348108*ganho) * xm2(47) - fix(0.731941079383758*ganho) * xm2(48);
        aux2(48) = fix(0.127225939811203*ganho) * xm2(43) - fix(0.149028467369333*ganho) * xm2(44) + fix(0.139234575651491*ganho) * xm2(45) - fix(0.205993547085165*ganho) * xm2(47) + fix(0.801179737852662*ganho) * xm2(48);
 
        
        aux3(1) = 3655645 * xm3(1) - 1101440 * xm3(2) - 758651 * xm3(3) + 1035395 * xm3(4) - 844695 * xm3(5) + 648496 * xm3(6) - 484897 * xm3(7);
        aux3(2) = -2439984 * xm3(1) + 6939916 * xm3(2) - 3924120 * xm3(3) + 1361883 * xm3(4)- 498240 * xm3(5);
        aux3(3) = 1472931 * xm3(1) - 4422581 * xm3(2) + 8643867 * xm3(3) - 5204211 * xm3(4) + 2287685 * xm3(5) - 1150681 * xm3(6) + 683680 * xm3(7);
        aux3(4) = -883510 * xm3(1) + 2662155 * xm3(2) - 5444664 * xm3(3) + 9411705 * xm3(4) - 5759535 * xm3(5) + 2679039 * xm3(6) - 1419150 * xm3(7) + 863951 * xm3(8) - 512743 * xm3(9);
        aux3(5) = 529731 * xm3(1) - 1596540 * xm3(2) + 3274971 * xm3(3) - 5905041 * xm3(4) + 9744665 * xm3(5) - 5994182 * xm3(6) + 2840007 * xm3(7) - 1527237 * xm3(8) + 935465 * xm3(9) - 559540 * xm3(10);
        aux3(6) = 957234 * xm3(2) - 1963959 * xm3(3) + 3550994 * xm3(4) - 6104670 * xm3(5) + 9885349 * xm3(6) - 6090692 * xm3(7) + 2904811 * xm3(8) - 1570113 * xm3(9) + 963522 * xm3(10) - 577731 * xm3(11);
        aux3(7) = -573917 * xm3(2) + 1177522 * xm3(3) - 2129450 * xm3(4) + 3670683 * xm3(5) - 6189018 * xm3(6) + 9943212 * xm3(7) - 6129545 * xm3(8) + 2930518 * xm3(9) - 1586935 * xm3(10) + 974429 * xm3(11) - 584746 * xm3(12);
        aux3(8) = -705993 * xm3(3) + 1276744 * xm3(4) - 2201211 * xm3(5) + 3721254 * xm3(6) - 6223710 * xm3(7) + 9966507 * xm3(8) - 6144958 * xm3(9) + 2940604 * xm3(10) - 1593474 * xm3(11) + 978635 * xm3(12) - 587434 * xm3(13);
        aux3(9) = -765482 * xm3(4) + 1319769 * xm3(5) - 2231531 * xm3(6) + 3742054 * xm3(7) - 6237677 * xm3(8) + 9975748 * xm3(9) - 6151005 * xm3(10) + 2944524 * xm3(11) - 1595996 * xm3(12) + 980247 * xm3(13) - 588458 * xm3(14);
        aux3(10) = -791277 * xm3(5) + 1337948 * xm3(6) - 2244002 * xm3(7) + 3750428 * xm3(8) - 6243218 * xm3(9) + 9979373 * xm3(10) - 6153356 * xm3(11) + 2946036 * xm3(12) - 1596962 * xm3(13) + 980861 * xm3(14) - 588846 * xm3(15);
        aux3(11) = 474416 * xm3(5) - 802176 * xm3(6) + 1345424 * xm3(7) - 2249023 * xm3(8) + 3753750 * xm3(9) - 6245391 * xm3(10) + 9980783 * xm3(11) - 6154262 * xm3(12) + 2946616 * xm3(13) - 1597331 * xm3(14) + 981093 * xm3(15) - 588993 * xm3(16);
        aux3(12) = 480950 * xm3(6) - 806659 * xm3(7) + 1348435 * xm3(8) - 2251014 * xm3(9) + 3755053 * xm3(10) - 6246236 * xm3(11) + 9981326 * xm3(12) - 6154610 * xm3(13) + 2946836 * xm3(14) -  1597470 * xm3(15) + 981181 * xm3(16) - 589048 * xm3(17);
        aux3(13) = 483638 * xm3(7) - 808464 * xm3(8) + 1349629 * xm3(9) - 2251796 * xm3(10) + 3755560 * xm3(11) - 6246562 * xm3(12) + 9981534 * xm3(13) - 6154742 * xm3(14) + 2946920 * xm3(15) - 1597523 * xm3(16) + 981214 * xm3(17) - 589069 * xm3(18);
        aux3(14) = 484720 * xm3(8) - 809180 * xm3(9) + 1350097 * xm3(10) - 2252099 * xm3(11) + 3755755 * xm3(12) - 6246687 * xm3(13) + 9981614 * xm3(14) - 6154792 * xm3(15) + 2946952 * xm3(16) - 1597543 * xm3(17) + 981227 * xm3(18) - 589076 * xm3(19);
        aux3(15) = 485149 * xm3(9) - 809461 * xm3(10) + 1350279 * xm3(11) - 2252216 * xm3(12) + 3755830 * xm3(13) - 6246734 * xm3(14) + 9981644 * xm3(15) - 6154811 * xm3(16) + 2946963 * xm3(17) - 1597550 * xm3(18) + 981231 * xm3(19) - 589079 * xm3(20);
        aux3(16) = 485318 * xm3(10) - 809570 * xm3(11) + 1350349 * xm3(12) - 2252261 * xm3(13) + 3755858 * xm3(14) - 6246753 * xm3(15) + 9981655 * xm3(16) - 6154818 * xm3(17) + 2946968 * xm3(18) - 1597553 * xm3(19) + 981233 * xm3(20) - 589080 * xm3(21);
        aux3(17) = 485383 * xm3(11) - 809612 * xm3(12) + 1350376 * xm3(13) - 2252278 * xm3(14) + 3755869 * xm3(15) - 6246759 * xm3(16) + 9981659 * xm3(17) - 6154821 * xm3(18) + 2946970 * xm3(19) - 1597554 * xm3(20) + 981234 * xm3(21) - 589081 * xm3(22);
        aux3(18) = 485409 * xm3(12) - 809628 * xm3(13) + 1350387 * xm3(14) - 2252285 * xm3(15) + 3755873 * xm3(16) - 6246762 * xm3(17) + 9981661 * xm3(18) - 6154822 * xm3(19) + 2946970 * xm3(20) - 1597554 * xm3(21) + 981234 * xm3(22) - 589081 * xm3(23);
        aux3(19) = 485418 * xm3(13) - 809634 * xm3(14) + 1350391 * xm3(15) - 2252287 * xm3(16) + 3755875 * xm3(17) - 6246763 * xm3(18) + 9981662 * xm3(19) - 6154822 * xm3(20) + 2946970 * xm3(21) - 1597554 * xm3(22) + 981234 * xm3(23) - 589081 * xm3(24);
        aux3(20) = 485422 * xm3(14) - 809637 * xm3(15) + 1350392 * xm3(16) - 2252288 * xm3(17) + 3755875 * xm3(18) - 6246763 * xm3(19) + 9981662 * xm3(20) - 6154822 * xm3(21) + 2946971 * xm3(22) - 1597554 * xm3(23) + 981234 * xm3(24) - 589081 * xm3(25);
        aux3(21) = 485423 * xm3(15) - 809638 * xm3(16) + 1350393 * xm3(17) - 2252289 * xm3(18) + 3755876 * xm3(19) - 6246763 * xm3(20) + 9981662 * xm3(21) - 6154822 * xm3(22) + 2946971 * xm3(23) - 1597554 * xm3(24) + 981234 * xm3(25) - 589081 * xm3(26);
        aux3(22) = 485424 * xm3(16) - 809638 * xm3(17) + 1350393 * xm3(18) - 2252289 * xm3(19) + 3755876 * xm3(20) - 6246763 * xm3(21) + 9981662 * xm3(22) - 6154822 * xm3(23) + 2946971 * xm3(24) - 1597554 * xm3(25) + 981234 * xm3(26) - 589081 * xm3(27);
        aux3(23) = 485424 * xm3(17) - 809638 * xm3(18) + 1350393 * xm3(19) - 2252289 * xm3(20) + 3755876 * xm3(21) - 6246763 * xm3(22) + 9981662 * xm3(23) - 6154822 * xm3(24) + 2946971 * xm3(25) - 1597554 * xm3(26) + 981234 * xm3(27) - 589081 * xm3(28);
        aux3(24) = 485424 * xm3(18) - 809638 * xm3(19) + 1350393 * xm3(20) - 2252289 * xm3(21) + 3755876 * xm3(22) - 6246763 * xm3(23) + 9981662 * xm3(24) - 6154822 * xm3(25) + 2946971 * xm3(26) - 1597554 * xm3(27) + 981234 * xm3(28) - 589081 * xm3(29);
        aux3(25) = 485424 * xm3(19) - 809638 * xm3(20) + 1350393 * xm3(21) - 2252289 * xm3(22) + 3755876 * xm3(23) - 6246763 * xm3(24) + 9981662 * xm3(25) - 6154822 * xm3(26) + 2946971 * xm3(27) - 1597554 * xm3(28) + 981234 * xm3(29) - 589081 * xm3(30);
        aux3(26) = 485424 * xm3(20) - 809638 * xm3(21) + 1350393 * xm3(22) - 2252289 * xm3(23) + 3755876 * xm3(24) - 6246763 * xm3(25) + 9981662 * xm3(26) - 6154822 * xm3(27) + 2946971 * xm3(28) - 1597554 * xm3(29) + 981234 * xm3(30) - 589081 * xm3(31);
        aux3(27) = 485424 * xm3(21) - 809638 * xm3(22) + 1350393 * xm3(23) - 2252289 * xm3(24) + 3755876 * xm3(25) - 6246763 * xm3(26) + 9981662 * xm3(27) - 6154822 * xm3(28) + 2946971 * xm3(29) - 1597554 * xm3(30) + 981234 * xm3(31) - 589081 * xm3(32);
        aux3(28) = 485424 * xm3(22) - 809638 * xm3(23) + 1350393 * xm3(24) - 2252289 * xm3(25) + 3755876 * xm3(26) - 6246763 * xm3(27) + 9981662 * xm3(28) - 6154822 * xm3(29) + 2946971 * xm3(30) - 1597554 * xm3(31) + 981234 * xm3(32) - 589081 * xm3(33);
        aux3(29) = 485424 * xm3(23) - 809638 * xm3(24) + 1350393 * xm3(25) - 2252289 * xm3(26) + 3755876 * xm3(27) - 6246763 * xm3(28) + 9981662 * xm3(29) - 6154822 * xm3(30) + 2946970 * xm3(31) - 1597554 * xm3(32) + 981234 * xm3(33) - 589080 * xm3(34);
        aux3(30) = 485424 * xm3(24) - 809638 * xm3(25) + 1350393 * xm3(26) - 2252289 * xm3(27) + 3755876 * xm3(28) - 6246763 * xm3(29) + 9981662 * xm3(30) - 6154822 * xm3(31) + 2946970 * xm3(32) - 1597554 * xm3(33) + 981233 * xm3(34) - 589079 * xm3(35);
        aux3(31) = 485424 * xm3(25) - 809638 * xm3(26) + 1350393 * xm3(27) - 2252289 * xm3(28) + 3755876 * xm3(29) - 6246763 * xm3(30) + 9981662 * xm3(31) - 6154822 * xm3(32) + 2946969 * xm3(33) - 1597553 * xm3(34) + 981231 * xm3(35) - 589076 * xm3(36);
        aux3(32) = 485424 * xm3(26) - 809638 * xm3(27) + 1350393 * xm3(28) - 2252288 * xm3(29) + 3755875 * xm3(30) - 6246763 * xm3(31) + 9981661 * xm3(32) - 6154820 * xm3(33) + 2946967 * xm3(34) - 1597549 * xm3(35) + 981226 * xm3(36) - 589068 * xm3(37);
        aux3(33) = 485424 * xm3(27) - 809638 * xm3(28) + 1350392 * xm3(29) - 2252288 * xm3(30) + 3755874 * xm3(31) - 6246761 * xm3(32) + 9981659 * xm3(33) - 6154817 * xm3(34) + 2946962 * xm3(35) - 1597540 * xm3(36) + 981212 * xm3(37) - 589046 * xm3(38);
        aux3(34) = 485424 * xm3(28) - 809637 * xm3(29) + 1350391 * xm3(30) - 2252286 * xm3(31) + 3755872 * xm3(32) - 6246757 * xm3(33) + 9981652 * xm3(34) - 6154807 * xm3(35) + 2946946 * xm3(36) - 1597516 * xm3(37) + 981174 * xm3(38) - 588987 * xm3(39);
        aux3(35) = 485423 * xm3(29) - 809636 * xm3(30) + 1350389 * xm3(31) - 2252282 * xm3(32) + 3755865 * xm3(33) - 6246747 * xm3(34) + 9981636 * xm3(35) - 6154780 * xm3(36) + 2946904 * xm3(37) - 1597450 * xm3(38) + 981072 * xm3(39) - 588830 * xm3(40);
        aux3(36) = 485420 * xm3(30) - 809631 * xm3(31) + 1350382 * xm3(32) - 2252271 * xm3(33) + 3755847 * xm3(34) - 6246718 * xm3(35) + 9981590 * xm3(36) - 6154708 * xm3(37) + 2946792 * xm3(38) - 1597275 * xm3(39) + 980802 * xm3(40) - 588417 * xm3(41);
        aux3(37) = 485412 * xm3(31) - 809619 * xm3(32) + 1350362 * xm3(33) - 2252240 * xm3(34) + 3755797 * xm3(35) - 6246639 * xm3(36) + 9981466 * xm3(37) - 6154515 * xm3(38) + 2946490 * xm3(39) - 1596811 * xm3(40) + 980092 * xm3(41) - 587344 * xm3(42);
        aux3(38) = 485391 * xm3(32) - 809585 * xm3(33) + 1350308 * xm3(34) - 2252154 * xm3(35) + 3755662 * xm3(36) - 6246426 * xm3(37) + 9981132 * xm3(38) - 6153996 * xm3(39) + 2945690 * xm3(40) - 1595587 * xm3(41) + 978243 * xm3(42) - 584590 * xm3(43);
        aux3(39) = 485333 * xm3(33) - 809492 * xm3(34) + 1350160 * xm3(35) - 2251920 * xm3(36) + 3755294 * xm3(37) - 6245850 * xm3(38) + 9980238 * xm3(39) - 6152616 * xm3(40) + 2943581 * xm3(41) - 1592401 * xm3(42) + 973497 * xm3(43) - 577672 * xm3(44);
        aux3(40) = 485173 * xm3(34) - 809239 * xm3(35) + 1349760 * xm3(36) - 2251290 * xm3(37) + 3754308 * xm3(38) - 6244317 * xm3(39) + 9977872 * xm3(40) - 6149001 * xm3(41) + 2938118 * xm3(42) - 1584264 * xm3(43) + 961637 * xm3(44) - 560842 * xm3(45);
        aux3(41) = 484741 * xm3(35) - 808555 * xm3(36) + 1348684 * xm3(37) - 2249606 * xm3(38) + 3751690 * xm3(39) - 6240279 * xm3(40) + 9971702 * xm3(41) - 6139676 * xm3(42) + 2924230 * xm3(43) - 1564020 * xm3(44) + 932909 * xm3(45) - 521122 * xm3(46);
        aux3(42) = 483557 * xm3(36) - 806693 * xm3(37) + 1345769 * xm3(38) - 2245075 * xm3(39) + 3744701 * xm3(40) - 6229600 * xm3(41) + 9955561 * xm3(42) - 6115637 * xm3(43) + 2889189 * xm3(44) - 1514296 * xm3(45)+ 864158 * xm3(46);
        aux3(43) = 480260 * xm3(37) - 801532 * xm3(38) + 1337747 * xm3(39) - 2232702 * xm3(40) + 3725793 * xm3(41) - 6201022 * xm3(42) + 9913001 * xm3(43) - 6053597 * xm3(44) + 2801155 * xm3(45) - 1392574 * xm3(46) + 702131 * xm3(47);
        aux3(44) = 471378 * xm3(38) - 787724 * xm3(39) + 1316450 * xm3(40) - 2200156 * xm3(41) + 3676603 * xm3(42) - 6127765 * xm3(43) + 9806213 * xm3(44) - 5902066 * xm3(45) + 2591636 * xm3(46) - 1113679 * xm3(47);
        aux3(45) = -754364 * xm3(40) + 1265470 * xm3(41) - 2123105 * xm3(42) + 3561854 * xm3(43) - 5960493 * xm3(44) + 9568857 * xm3(45) - 5573878 * xm3(46) + 2154778 * xm3(47) - 605382 * xm3(48);
        aux3(46) = -672638 * xm3(41) + 1141948 * xm3(42) - 1939149 * xm3(43) + 3293697 * xm3(44) - 5579983 * xm3(45) + 9042732 * xm3(46) - 4873545 * xm3(47) + 1339920 * xm3(48);
        aux3(47) = 734791 * xm3(43) - 1345626 * xm3(44) + 2451499 * xm3(45) - 4415489 * xm3(46) + 7492654 * xm3(47) - 3069983 * xm3(48);
        aux3(48) = 533624 * xm3(43) - 625070 * xm3(44) + 583992 * xm3(45) -  863999 * xm3(47) + 3360391 * xm3(48);
 
end

%%%%%%%%%%%%%%%%% AGORA AUX TEM GANHO = ganho^2 %%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%% XM RECEBE AUX %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
for i=1:1:48
xm(i) = aux(i);
xm2(i) = aux2(i);
xm2(i) = fix(aux2(i));
xm3(i) = aux3(i);
end
xm(xm<0) = 0;
xm2(xm2<0) = 0;
xm3(xm3<0) = 0;
xm2 = fix(xm2);

%%%%%%%%%%%%%%%%%%% AGORA XM TEM GANHO = ganho^2 %%%%%%%%%%%%%%%%%%%%%%

for it = 1:iterations
    for janela = 1:totalJanelas
        pass = ((janela * window) - (window -1));
        signalW(Cd+1:end-Ce) = signalN(pass:pass + (window -2));
        
        x = signalW(4:end - 3 - toall)';
        Hs = (H' * signalW(1:end - toall)');
        
%%%%%%%%%%%%%%%%%%%%%%%% MULTIPLIQUEI D1 PELO GANHO %%%%%%%%%%%%%%%%%%%
        for i=1:1:48
             d1(i)= d1(i)*ganho/4;
             d2(i) = d2(i)*ganho/4;
             d2(i) = fix(d2(i));
        end
        ganho1 = ganho/4;
%%%%%%%%%%%%%%%%%%%%%%%%% AGORA D1 TEM GANHO = ganho^3 %%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%% ATUALIZANDO AUX %%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%% MULTIPLIQUEI AS CONSTANTES PELO GANHO %%%%%%%%%%%%        
        for m = 1:1:1
            aux(1) = xm(1)*ganho - (-d1(1) + 1.5464132985428416*ganho1 * xm(1) + 1.1139936470222562*ganho1 * xm(2) + 0.44529883180639995*ganho1 * xm(3) + 0.11965246577979999*ganho1 * xm(4));
            aux(2) = xm(2)*ganho - (-d1(2) + 1.1139936470222562*ganho1 * xm(1) + 1.5464132985428416*ganho1 * xm(2) + 1.1139936470222562*ganho1 * xm(3) + 0.44529883180639995*ganho1 * xm(4) + 0.11965246577979999*ganho1 * xm(5));
            aux(3) = xm(3)*ganho - (-d1(3) + 0.44529883180639995*ganho1 * xm(1) + 1.1139936470222562*ganho1 * xm(2) + 1.5464132985428416*ganho1 * xm(3) + 1.1139936470222562*ganho1 * xm(4) + 0.44529883180639995*ganho1 * xm(5) + 0.11965246577979999*ganho1 * xm(6));
            aux(4) = xm(4)*ganho - (-d1(4) + 0.11965246577979999*ganho1 * xm(1) + 0.44529883180639995*ganho1 * xm(2) + 1.1139936470222562*ganho1 * xm(3) + 1.5464132985428416*ganho1 * xm(4) + 1.1139936470222562*ganho1 * xm(5) + 0.44529883180639995*ganho1 * xm(6) + 0.11965246577979999*ganho1 * xm(7));
            aux(5) = xm(5)*ganho - (-d1(5) + 0.11965246577979999*ganho1 * xm(2) + 0.44529883180639995*ganho1 * xm(3) + 1.1139936470222562*ganho1 * xm(4) + 1.5464132985428416*ganho1 * xm(5) + 1.1139936470222562*ganho1 * xm(6) + 0.44529883180639995*ganho1 * xm(7) + 0.11965246577979999*ganho1 * xm(8));
            aux(6) = xm(6)*ganho - (-d1(6) + 0.11965246577979999*ganho1 * xm(3) + 0.44529883180639995*ganho1 * xm(4) + 1.1139936470222562*ganho1 * xm(5) + 1.5464132985428416*ganho1 * xm(6) + 1.1139936470222562*ganho1 * xm(7) + 0.44529883180639995*ganho1 * xm(8) + 0.11965246577979999*ganho1 * xm(9));
            aux(7) = xm(7)*ganho - (-d1(7) + 0.11965246577979999*ganho1 * xm(4) + 0.44529883180639995*ganho1 * xm(5) + 1.1139936470222562*ganho1 * xm(6) + 1.5464132985428416*ganho1 * xm(7) + 1.1139936470222562*ganho1 * xm(8) + 0.44529883180639995*ganho1 * xm(9) + 0.11965246577979999*ganho1 * xm(10));
            aux(8) = xm(8)*ganho - (-d1(8) + 0.11965246577979999*ganho1 * xm(5) + 0.44529883180639995*ganho1 * xm(6) + 1.1139936470222562*ganho1 * xm(7) + 1.5464132985428416*ganho1 * xm(8) + 1.1139936470222562*ganho1 * xm(9) + 0.44529883180639995*ganho1 * xm(10) + 0.11965246577979999*ganho1 * xm(11));
            aux(9) = xm(9)*ganho - (-d1(9) + 0.11965246577979999*ganho1 * xm(6) + 0.44529883180639995*ganho1 * xm(7) + 1.1139936470222562*ganho1 * xm(8) + 1.5464132985428416*ganho1 * xm(9) + 1.1139936470222562*ganho1 * xm(10) + 0.44529883180639995*ganho1 * xm(11) + 0.11965246577979999*ganho1 * xm(12));
            aux(10) = xm(10)*ganho - (-d1(10) + 0.11965246577979999*ganho1 * xm(7) + 0.44529883180639995*ganho1 * xm(8) + 1.1139936470222562*ganho1 * xm(9) + 1.5464132985428416*ganho1 * xm(10) + 1.1139936470222562*ganho1 * xm(11) + 0.44529883180639995*ganho1 * xm(12) + 0.11965246577979999*ganho1 * xm(13));
            aux(11) = xm(11)*ganho - (-d1(11) + 0.11965246577979999*ganho1 * xm(8) + 0.44529883180639995*ganho1 * xm(9) + 1.1139936470222562*ganho1 * xm(10) + 1.5464132985428416*ganho1 * xm(11) + 1.1139936470222562*ganho1 * xm(12) + 0.44529883180639995*ganho1 * xm(13) + 0.11965246577979999*ganho1 * xm(14));
            aux(12) = xm(12)*ganho - (-d1(12) + 0.11965246577979999*ganho1 * xm(9) + 0.44529883180639995*ganho1 * xm(10) + 1.1139936470222562*ganho1 * xm(11) + 1.5464132985428416*ganho1 * xm(12) + 1.1139936470222562*ganho1 * xm(13) + 0.44529883180639995*ganho1 * xm(14) + 0.11965246577979999*ganho1 * xm(15));
            aux(13) = xm(13)*ganho - (-d1(13) + 0.11965246577979999*ganho1 * xm(10) + 0.44529883180639995*ganho1 * xm(11) + 1.1139936470222562*ganho1 * xm(12) + 1.5464132985428416*ganho1 * xm(13) + 1.1139936470222562*ganho1 * xm(14) + 0.44529883180639995*ganho1 * xm(15) + 0.11965246577979999*ganho1 * xm(16));
            aux(14) = xm(14)*ganho - (-d1(14) + 0.11965246577979999*ganho1 * xm(11) + 0.44529883180639995*ganho1 * xm(12) + 1.1139936470222562*ganho1 * xm(13) + 1.5464132985428416*ganho1 * xm(14) + 1.1139936470222562*ganho1 * xm(15) + 0.44529883180639995*ganho1 * xm(16) + 0.11965246577979999*ganho1 * xm(17));
            aux(15) = xm(15)*ganho - (-d1(15) + 0.11965246577979999*ganho1 * xm(12) + 0.44529883180639995*ganho1 * xm(13) + 1.1139936470222562*ganho1 * xm(14) + 1.5464132985428416*ganho1 * xm(15) + 1.1139936470222562*ganho1 * xm(16) + 0.44529883180639995*ganho1 * xm(17) + 0.11965246577979999*ganho1 * xm(18));
            aux(16) = xm(16)*ganho - (-d1(16) + 0.11965246577979999*ganho1 * xm(13) + 0.44529883180639995*ganho1 * xm(14) + 1.1139936470222562*ganho1 * xm(15) + 1.5464132985428416*ganho1 * xm(16) + 1.1139936470222562*ganho1 * xm(17) + 0.44529883180639995*ganho1 * xm(18) + 0.11965246577979999*ganho1 * xm(19));
            aux(17) = xm(17)*ganho - (-d1(17) + 0.11965246577979999*ganho1 * xm(14) + 0.44529883180639995*ganho1 * xm(15) + 1.1139936470222562*ganho1 * xm(16) + 1.5464132985428416*ganho1 * xm(17) + 1.1139936470222562*ganho1 * xm(18) + 0.44529883180639995*ganho1 * xm(19) + 0.11965246577979999*ganho1 * xm(20));
            aux(18) = xm(18)*ganho - (-d1(18) + 0.11965246577979999*ganho1 * xm(15) + 0.44529883180639995*ganho1 * xm(16) + 1.1139936470222562*ganho1 * xm(17) + 1.5464132985428416*ganho1 * xm(18) + 1.1139936470222562*ganho1 * xm(19) + 0.44529883180639995*ganho1 * xm(20) + 0.11965246577979999*ganho1 * xm(21));
            aux(19) = xm(19)*ganho - (-d1(19) + 0.11965246577979999*ganho1 * xm(16) + 0.44529883180639995*ganho1 * xm(17) + 1.1139936470222562*ganho1 * xm(18) + 1.5464132985428416*ganho1 * xm(19) + 1.1139936470222562*ganho1 * xm(20) + 0.44529883180639995*ganho1 * xm(21) + 0.11965246577979999*ganho1 * xm(22));
            aux(20) = xm(20)*ganho - (-d1(20) + 0.11965246577979999*ganho1 * xm(17) + 0.44529883180639995*ganho1 * xm(18) + 1.1139936470222562*ganho1 * xm(19) + 1.5464132985428416*ganho1 * xm(20) + 1.1139936470222562*ganho1 * xm(21) + 0.44529883180639995*ganho1 * xm(22) + 0.11965246577979999*ganho1 * xm(23));
            aux(21) = xm(21)*ganho - (-d1(21) + 0.11965246577979999*ganho1 * xm(18) + 0.44529883180639995*ganho1 * xm(19) + 1.1139936470222562*ganho1 * xm(20) + 1.5464132985428416*ganho1 * xm(21) + 1.1139936470222562*ganho1 * xm(22) + 0.44529883180639995*ganho1 * xm(23) + 0.11965246577979999*ganho1 * xm(24));
            aux(22) = xm(22)*ganho - (-d1(22) + 0.11965246577979999*ganho1 * xm(19) + 0.44529883180639995*ganho1 * xm(20) + 1.1139936470222562*ganho1 * xm(21) + 1.5464132985428416*ganho1 * xm(22) + 1.1139936470222562*ganho1 * xm(23) + 0.44529883180639995*ganho1 * xm(24) + 0.11965246577979999*ganho1 * xm(25));
            aux(23) = xm(23)*ganho - (-d1(23) + 0.11965246577979999*ganho1 * xm(20) + 0.44529883180639995*ganho1 * xm(21) + 1.1139936470222562*ganho1 * xm(22) + 1.5464132985428416*ganho1 * xm(23) + 1.1139936470222562*ganho1 * xm(24) + 0.44529883180639995*ganho1 * xm(25) + 0.11965246577979999*ganho1 * xm(26));
            aux(24) = xm(24)*ganho - (-d1(24) + 0.11965246577979999*ganho1 * xm(21) + 0.44529883180639995*ganho1 * xm(22) + 1.1139936470222562*ganho1 * xm(23) + 1.5464132985428416*ganho1 * xm(24) + 1.1139936470222562*ganho1 * xm(25) + 0.44529883180639995*ganho1 * xm(26) + 0.11965246577979999*ganho1 * xm(27));
            aux(25) = xm(25)*ganho - (-d1(25) + 0.11965246577979999*ganho1 * xm(22) + 0.44529883180639995*ganho1 * xm(23) + 1.1139936470222562*ganho1 * xm(24) + 1.5464132985428416*ganho1 * xm(25) + 1.1139936470222562*ganho1 * xm(26) + 0.44529883180639995*ganho1 * xm(27) + 0.11965246577979999*ganho1 * xm(28));
            aux(26) = xm(26)*ganho - (-d1(26) + 0.11965246577979999*ganho1 * xm(23) + 0.44529883180639995*ganho1 * xm(24) + 1.1139936470222562*ganho1 * xm(25) + 1.5464132985428416*ganho1 * xm(26) + 1.1139936470222562*ganho1 * xm(27) + 0.44529883180639995*ganho1 * xm(28) + 0.11965246577979999*ganho1 * xm(29));
            aux(27) = xm(27)*ganho - (-d1(27) + 0.11965246577979999*ganho1 * xm(24) + 0.44529883180639995*ganho1 * xm(25) + 1.1139936470222562*ganho1 * xm(26) + 1.5464132985428416*ganho1 * xm(27) + 1.1139936470222562*ganho1 * xm(28) + 0.44529883180639995*ganho1 * xm(29) + 0.11965246577979999*ganho1 * xm(30));
            aux(28) = xm(28)*ganho - (-d1(28) + 0.11965246577979999*ganho1 * xm(25) + 0.44529883180639995*ganho1 * xm(26) + 1.1139936470222562*ganho1 * xm(27) + 1.5464132985428416*ganho1 * xm(28) + 1.1139936470222562*ganho1 * xm(29) + 0.44529883180639995*ganho1 * xm(30) + 0.11965246577979999*ganho1 * xm(31));
            aux(29) = xm(29)*ganho - (-d1(29) + 0.11965246577979999*ganho1 * xm(26) + 0.44529883180639995*ganho1 * xm(27) + 1.1139936470222562*ganho1 * xm(28) + 1.5464132985428416*ganho1 * xm(29) + 1.1139936470222562*ganho1 * xm(30) + 0.44529883180639995*ganho1 * xm(31) + 0.11965246577979999*ganho1 * xm(32));
            aux(30) = xm(30)*ganho - (-d1(30) + 0.11965246577979999*ganho1 * xm(27) + 0.44529883180639995*ganho1 * xm(28) + 1.1139936470222562*ganho1 * xm(29) + 1.5464132985428416*ganho1 * xm(30) + 1.1139936470222562*ganho1 * xm(31) + 0.44529883180639995*ganho1 * xm(32) + 0.11965246577979999*ganho1 * xm(33));
            aux(31) = xm(31)*ganho - (-d1(31) + 0.11965246577979999*ganho1 * xm(28) + 0.44529883180639995*ganho1 * xm(29) + 1.1139936470222562*ganho1 * xm(30) + 1.5464132985428416*ganho1 * xm(31) + 1.1139936470222562*ganho1 * xm(32) + 0.44529883180639995*ganho1 * xm(33) + 0.11965246577979999*ganho1 * xm(34));
            aux(32) = xm(32)*ganho - (-d1(32) + 0.11965246577979999*ganho1 * xm(29) + 0.44529883180639995*ganho1 * xm(30) + 1.1139936470222562*ganho1 * xm(31) + 1.5464132985428416*ganho1 * xm(32) + 1.1139936470222562*ganho1 * xm(33) + 0.44529883180639995*ganho1 * xm(34) + 0.11965246577979999*ganho1 * xm(35));
            aux(33) = xm(33)*ganho - (-d1(33) + 0.11965246577979999*ganho1 * xm(30) + 0.44529883180639995*ganho1 * xm(31) + 1.1139936470222562*ganho1 * xm(32) + 1.5464132985428416*ganho1 * xm(33) + 1.1139936470222562*ganho1 * xm(34) + 0.44529883180639995*ganho1 * xm(35) + 0.11965246577979999*ganho1 * xm(36));
            aux(34) = xm(34)*ganho - (-d1(34) + 0.11965246577979999*ganho1 * xm(31) + 0.44529883180639995*ganho1 * xm(32) + 1.1139936470222562*ganho1 * xm(33) + 1.5464132985428416*ganho1 * xm(34) + 1.1139936470222562*ganho1 * xm(35) + 0.44529883180639995*ganho1 * xm(36) + 0.11965246577979999*ganho1 * xm(37));
            aux(35) = xm(35)*ganho - (-d1(35) + 0.11965246577979999*ganho1 * xm(32) + 0.44529883180639995*ganho1 * xm(33) + 1.1139936470222562*ganho1 * xm(34) + 1.5464132985428416*ganho1 * xm(35) + 1.1139936470222562*ganho1 * xm(36) + 0.44529883180639995*ganho1 * xm(37) + 0.11965246577979999*ganho1 * xm(38));
            aux(36) = xm(36)*ganho - (-d1(36) + 0.11965246577979999*ganho1 * xm(33) + 0.44529883180639995*ganho1 * xm(34) + 1.1139936470222562*ganho1 * xm(35) + 1.5464132985428416*ganho1 * xm(36) + 1.1139936470222562*ganho1 * xm(37) + 0.44529883180639995*ganho1 * xm(38) + 0.11965246577979999*ganho1 * xm(39));
            aux(37) = xm(37)*ganho - (-d1(37) + 0.11965246577979999*ganho1 * xm(34) + 0.44529883180639995*ganho1 * xm(35) + 1.1139936470222562*ganho1 * xm(36) + 1.5464132985428416*ganho1 * xm(37) + 1.1139936470222562*ganho1 * xm(38) + 0.44529883180639995*ganho1 * xm(39) + 0.11965246577979999*ganho1 * xm(40));
            aux(38) = xm(38)*ganho - (-d1(38) + 0.11965246577979999*ganho1 * xm(35) + 0.44529883180639995*ganho1 * xm(36) + 1.1139936470222562*ganho1 * xm(37) + 1.5464132985428416*ganho1 * xm(38) + 1.1139936470222562*ganho1 * xm(39) + 0.44529883180639995*ganho1 * xm(40) + 0.11965246577979999*ganho1 * xm(41));
            aux(39) = xm(39)*ganho - (-d1(39) + 0.11965246577979999*ganho1 * xm(36) + 0.44529883180639995*ganho1 * xm(37) + 1.1139936470222562*ganho1 * xm(38) + 1.5464132985428416*ganho1 * xm(39) + 1.1139936470222562*ganho1 * xm(40) + 0.44529883180639995*ganho1 * xm(41) + 0.11965246577979999*ganho1 * xm(42));
            aux(40) = xm(40)*ganho - (-d1(40) + 0.11965246577979999*ganho1 * xm(37) + 0.44529883180639995*ganho1 * xm(38) + 1.1139936470222562*ganho1 * xm(39) + 1.5464132985428416*ganho1 * xm(40) + 1.1139936470222562*ganho1 * xm(41) + 0.44529883180639995*ganho1 * xm(42) + 0.11965246577979999*ganho1 * xm(43));
            aux(41) = xm(41)*ganho - (-d1(41) + 0.11965246577979999*ganho1 * xm(38) + 0.44529883180639995*ganho1 * xm(39) + 1.1139936470222562*ganho1 * xm(40) + 1.5464132985428416*ganho1 * xm(41) + 1.1139936470222562*ganho1 * xm(42) + 0.44529883180639995*ganho1 * xm(43) + 0.11965246577979999*ganho1 * xm(44));
            aux(42) = xm(42)*ganho - (-d1(42) + 0.11965246577979999*ganho1 * xm(39) + 0.44529883180639995*ganho1 * xm(40) + 1.1139936470222562*ganho1 * xm(41) + 1.5464132985428416*ganho1 * xm(42) + 1.1139936470222562*ganho1 * xm(43) + 0.44529883180639995*ganho1 * xm(44) + 0.11965246577979999*ganho1 * xm(45));
            aux(43) = xm(43)*ganho - (-d1(43) + 0.11965246577979999*ganho1 * xm(40) + 0.44529883180639995*ganho1 * xm(41) + 1.1139936470222562*ganho1 * xm(42) + 1.5464132985428416*ganho1 * xm(43) + 1.1139936470222562*ganho1 * xm(44) + 0.44529883180639995*ganho1 * xm(45) + 0.11965246577979999*ganho1 * xm(46));
            aux(44) = xm(44)*ganho - (-d1(44) + 0.11965246577979999*ganho1 * xm(41) + 0.44529883180639995*ganho1 * xm(42) + 1.1139936470222562*ganho1 * xm(43) + 1.5464132985428416*ganho1 * xm(44) + 1.1139936470222562*ganho1 * xm(45) + 0.44529883180639995*ganho1 * xm(46) + 0.11965246577979999*ganho1 * xm(47));
            aux(45) = xm(45)*ganho - (-d1(45) + 0.11965246577979999*ganho1 * xm(42) + 0.44529883180639995*ganho1 * xm(43) + 1.1139936470222562*ganho1 * xm(44) + 1.5464132985428416*ganho1 * xm(45) + 1.1139936470222562*ganho1 * xm(46) + 0.44529883180639995*ganho1 * xm(47) + 0.11965246577979999*ganho1 * xm(48));
            aux(46) = xm(46)*ganho - (-d1(46) + 0.11965246577979999*ganho1 * xm(43) + 0.44529883180639995*ganho1 * xm(44) + 1.1139936470222562*ganho1 * xm(45) + 1.5464132985428416*ganho1 * xm(46) + 1.1139936470222562*ganho1 * xm(47) + 0.44529883180639995*ganho1 * xm(48));
            aux(47) = xm(47)*ganho - (-d1(47) + 0.11965246577979999*ganho1 * xm(44) + 0.44529883180639995*ganho1 * xm(45) + 1.1139936470222562*ganho1 * xm(46) + 1.5464132985428416*ganho1 * xm(47) + 1.1139936470222562*ganho1 * xm(48));
            aux(48) = xm(48)*ganho - (-d1(48) + 0.11965246577979999*ganho1 * xm(45) + 0.44529883180639995*ganho1 * xm(46) + 1.1139936470222562*ganho1 * xm(47) + 1.5464132985428416*ganho1 * xm(48));
                        

            aux2(1) = fix(xm2(1)*ganho) - (-d2(1) + fix(1.5464132985428416*ganho1) * xm2(1) + fix(1.1139936470222562*ganho1) * xm2(2) + fix(0.44529883180639995*ganho1) * xm2(3) + fix(0.11965246577979999*ganho1) * xm2(4));
            aux2(2) = fix(xm2(2)*ganho) - (-d2(2) + fix(1.1139936470222562*ganho1) * xm2(1) + fix(1.5464132985428416*ganho1) * xm2(2) + fix(1.1139936470222562*ganho1) * xm2(3) + fix(0.44529883180639995*ganho1) * xm2(4) + fix(0.11965246577979999*ganho1) * xm2(5));
            aux2(3) = fix(xm2(3)*ganho) - (-d2(3) + fix(0.44529883180639995*ganho1) * xm2(1) + fix(1.1139936470222562*ganho1) * xm2(2) + fix(1.5464132985428416*ganho1) * xm2(3) + fix(1.1139936470222562*ganho1) * xm2(4) + fix(0.44529883180639995*ganho1) * xm2(5) + fix(0.11965246577979999*ganho1) * xm2(6));
            aux2(4) = fix(xm2(4)*ganho) - (-d2(4) + fix(0.11965246577979999*ganho1) * xm2(1) + fix(0.44529883180639995*ganho1) * xm2(2) + fix(1.1139936470222562*ganho1) * xm2(3) + fix(1.5464132985428416*ganho1) * xm2(4) + fix(1.1139936470222562*ganho1) * xm2(5) + fix(0.44529883180639995*ganho1) * xm2(6) + fix(0.11965246577979999*ganho1) * xm2(7));
            aux2(5) = fix(xm2(5)*ganho) - (-d2(5) + fix(0.11965246577979999*ganho1) * xm2(2) + fix(0.44529883180639995*ganho1) * xm2(3) + fix(1.1139936470222562*ganho1) * xm2(4) + fix(1.5464132985428416*ganho1) * xm2(5) + fix(1.1139936470222562*ganho1) * xm2(6) + fix(0.44529883180639995*ganho1) * xm2(7) + fix(0.11965246577979999*ganho1) * xm2(8));
            aux2(6) = fix(xm2(6)*ganho) - (-d2(6) + fix(0.11965246577979999*ganho1) * xm2(3) + fix(0.44529883180639995*ganho1) * xm2(4) + fix(1.1139936470222562*ganho1) * xm2(5) + fix(1.5464132985428416*ganho1) * xm2(6) + fix(1.1139936470222562*ganho1) * xm2(7) + fix(0.44529883180639995*ganho1) * xm2(8) + fix(0.11965246577979999*ganho1) * xm2(9));
            aux2(7) = fix(xm2(7)*ganho) - (-d2(7) + fix(0.11965246577979999*ganho1) * xm2(4) + fix(0.44529883180639995*ganho1) * xm2(5) + fix(1.1139936470222562*ganho1) * xm2(6) + fix(1.5464132985428416*ganho1) * xm2(7) + fix(1.1139936470222562*ganho1) * xm2(8) + fix(0.44529883180639995*ganho1) * xm2(9) + fix(0.11965246577979999*ganho1) * xm2(10));
            aux2(8) = fix(xm2(8)*ganho) - (-d2(8) + fix(0.11965246577979999*ganho1) * xm2(5) + fix(0.44529883180639995*ganho1) * xm2(6) + fix(1.1139936470222562*ganho1) * xm2(7) + fix(1.5464132985428416*ganho1) * xm2(8) + fix(1.1139936470222562*ganho1) * xm2(9) + fix(0.44529883180639995*ganho1) * xm2(10) + fix(0.11965246577979999*ganho1) * xm2(11));
            aux2(9) = fix(xm2(9)*ganho) - (-d2(9) + fix(0.11965246577979999*ganho1) * xm2(6) + fix(0.44529883180639995*ganho1) * xm2(7) + fix(1.1139936470222562*ganho1) * xm2(8) + fix(1.5464132985428416*ganho1) * xm2(9) + fix(1.1139936470222562*ganho1) * xm2(10) + fix(0.44529883180639995*ganho1) * xm2(11) + fix(0.11965246577979999*ganho1) * xm2(12));
            aux2(10) = fix(xm2(10)*ganho) - (-d2(10) + fix(0.11965246577979999*ganho1) * xm2(7) + fix(0.44529883180639995*ganho1) * xm2(8) + fix(1.1139936470222562*ganho1) * xm2(9) + fix(1.5464132985428416*ganho1) * xm2(10) + fix(1.1139936470222562*ganho1) * xm2(11) + fix(0.44529883180639995*ganho1) * xm2(12) + fix(0.11965246577979999*ganho1) * xm2(13));
            aux2(11) = fix(xm2(11)*ganho) - (-d2(11) + fix(0.11965246577979999*ganho1) * xm2(8) + fix(0.44529883180639995*ganho1) * xm2(9) + fix(1.1139936470222562*ganho1) * xm2(10) + fix(1.5464132985428416*ganho1) * xm2(11) + fix(1.1139936470222562*ganho1) * xm2(12) + fix(0.44529883180639995*ganho1) * xm2(13) + fix(0.11965246577979999*ganho1) * xm2(14));
            aux2(12) = fix(xm2(12)*ganho) - (-d2(12) + fix(0.11965246577979999*ganho1) * xm2(9) + fix(0.44529883180639995*ganho1) * xm2(10) + fix(1.1139936470222562*ganho1) * xm2(11) + fix(1.5464132985428416*ganho1) * xm2(12) + fix(1.1139936470222562*ganho1) * xm2(13) + fix(0.44529883180639995*ganho1) * xm2(14) + fix(0.11965246577979999*ganho1) * xm2(15));
            aux2(13) = fix(xm2(13)*ganho) - (-d2(13) + fix(0.11965246577979999*ganho1) * xm2(10) + fix(0.44529883180639995*ganho1) * xm2(11) + fix(1.1139936470222562*ganho1) * xm2(12) + fix(1.5464132985428416*ganho1) * xm2(13) + fix(1.1139936470222562*ganho1) * xm2(14) + fix(0.44529883180639995*ganho1) * xm2(15) + fix(0.11965246577979999*ganho1) * xm2(16));
            aux2(14) = fix(xm2(14)*ganho) - (-d2(14) + fix(0.11965246577979999*ganho1) * xm2(11) + fix(0.44529883180639995*ganho1) * xm2(12) + fix(1.1139936470222562*ganho1) * xm2(13) + fix(1.5464132985428416*ganho1) * xm2(14) + fix(1.1139936470222562*ganho1) * xm2(15) + fix(0.44529883180639995*ganho1) * xm2(16) + fix(0.11965246577979999*ganho1) * xm2(17));
            aux2(15) = fix(xm2(15)*ganho) - (-d2(15) + fix(0.11965246577979999*ganho1) * xm2(12) + fix(0.44529883180639995*ganho1) * xm2(13) + fix(1.1139936470222562*ganho1) * xm2(14) + fix(1.5464132985428416*ganho1) * xm2(15) + fix(1.1139936470222562*ganho1) * xm2(16) + fix(0.44529883180639995*ganho1) * xm2(17) + fix(0.11965246577979999*ganho1) * xm2(18));
            aux2(16) = fix(xm2(16)*ganho) - (-d2(16) + fix(0.11965246577979999*ganho1) * xm2(13) + fix(0.44529883180639995*ganho1) * xm2(14) + fix(1.1139936470222562*ganho1) * xm2(15) + fix(1.5464132985428416*ganho1) * xm2(16) + fix(1.1139936470222562*ganho1) * xm2(17) + fix(0.44529883180639995*ganho1) * xm2(18) + fix(0.11965246577979999*ganho1) * xm2(19));
            aux2(17) = fix(xm2(17)*ganho) - (-d2(17) + fix(0.11965246577979999*ganho1) * xm2(14) + fix(0.44529883180639995*ganho1) * xm2(15) + fix(1.1139936470222562*ganho1) * xm2(16) + fix(1.5464132985428416*ganho1) * xm2(17) + fix(1.1139936470222562*ganho1) * xm2(18) + fix(0.44529883180639995*ganho1) * xm2(19) + fix(0.11965246577979999*ganho1) * xm2(20));
            aux2(18) = fix(xm2(18)*ganho) - (-d2(18) + fix(0.11965246577979999*ganho1) * xm2(15) + fix(0.44529883180639995*ganho1) * xm2(16) + fix(1.1139936470222562*ganho1) * xm2(17) + fix(1.5464132985428416*ganho1) * xm2(18) + fix(1.1139936470222562*ganho1) * xm2(19) + fix(0.44529883180639995*ganho1) * xm2(20) + fix(0.11965246577979999*ganho1) * xm2(21));
            aux2(19) = fix(xm2(19)*ganho) - (-d2(19) + fix(0.11965246577979999*ganho1) * xm2(16) + fix(0.44529883180639995*ganho1) * xm2(17) + fix(1.1139936470222562*ganho1) * xm2(18) + fix(1.5464132985428416*ganho1) * xm2(19) + fix(1.1139936470222562*ganho1) * xm2(20) + fix(0.44529883180639995*ganho1) * xm2(21) + fix(0.11965246577979999*ganho1) * xm2(22));
            aux2(20) = fix(xm2(20)*ganho) - (-d2(20) + fix(0.11965246577979999*ganho1) * xm2(17) + fix(0.44529883180639995*ganho1) * xm2(18) + fix(1.1139936470222562*ganho1) * xm2(19) + fix(1.5464132985428416*ganho1) * xm2(20) + fix(1.1139936470222562*ganho1) * xm2(21) + fix(0.44529883180639995*ganho1) * xm2(22) + fix(0.11965246577979999*ganho1) * xm2(23));
            aux2(21) = fix(xm2(21)*ganho) - (-d2(21) + fix(0.11965246577979999*ganho1) * xm2(18) + fix(0.44529883180639995*ganho1) * xm2(19) + fix(1.1139936470222562*ganho1) * xm2(20) + fix(1.5464132985428416*ganho1) * xm2(21) + fix(1.1139936470222562*ganho1) * xm2(22) + fix(0.44529883180639995*ganho1) * xm2(23) + fix(0.11965246577979999*ganho1) * xm2(24));
            aux2(22) = fix(xm2(22)*ganho) - (-d2(22) + fix(0.11965246577979999*ganho1) * xm2(19) + fix(0.44529883180639995*ganho1) * xm2(20) + fix(1.1139936470222562*ganho1) * xm2(21) + fix(1.5464132985428416*ganho1) * xm2(22) + fix(1.1139936470222562*ganho1) * xm2(23) + fix(0.44529883180639995*ganho1) * xm2(24) + fix(0.11965246577979999*ganho1) * xm2(25));
            aux2(23) = fix(xm2(23)*ganho) - (-d2(23) + fix(0.11965246577979999*ganho1) * xm2(20) + fix(0.44529883180639995*ganho1) * xm2(21) + fix(1.1139936470222562*ganho1) * xm2(22) + fix(1.5464132985428416*ganho1) * xm2(23) + fix(1.1139936470222562*ganho1) * xm2(24) + fix(0.44529883180639995*ganho1) * xm2(25) + fix(0.11965246577979999*ganho1) * xm2(26));
            aux2(24) = fix(xm2(24)*ganho) - (-d2(24) + fix(0.11965246577979999*ganho1) * xm2(21) + fix(0.44529883180639995*ganho1) * xm2(22) + fix(1.1139936470222562*ganho1) * xm2(23) + fix(1.5464132985428416*ganho1) * xm2(24) + fix(1.1139936470222562*ganho1) * xm2(25) + fix(0.44529883180639995*ganho1) * xm2(26) + fix(0.11965246577979999*ganho1) * xm2(27));
            aux2(25) = fix(xm2(25)*ganho) - (-d2(25) + fix(0.11965246577979999*ganho1) * xm2(22) + fix(0.44529883180639995*ganho1) * xm2(23) + fix(1.1139936470222562*ganho1) * xm2(24) + fix(1.5464132985428416*ganho1) * xm2(25) + fix(1.1139936470222562*ganho1) * xm2(26) + fix(0.44529883180639995*ganho1) * xm2(27) + fix(0.11965246577979999*ganho1) * xm2(28));
            aux2(26) = fix(xm2(26)*ganho) - (-d2(26) + fix(0.11965246577979999*ganho1) * xm2(23) + fix(0.44529883180639995*ganho1) * xm2(24) + fix(1.1139936470222562*ganho1) * xm2(25) + fix(1.5464132985428416*ganho1) * xm2(26) + fix(1.1139936470222562*ganho1) * xm2(27) + fix(0.44529883180639995*ganho1) * xm2(28) + fix(0.11965246577979999*ganho1) * xm2(29));
            aux2(27) = fix(xm2(27)*ganho) - (-d2(27) + fix(0.11965246577979999*ganho1) * xm2(24) + fix(0.44529883180639995*ganho1) * xm2(25) + fix(1.1139936470222562*ganho1) * xm2(26) + fix(1.5464132985428416*ganho1) * xm2(27) + fix(1.1139936470222562*ganho1) * xm2(28) + fix(0.44529883180639995*ganho1) * xm2(29) + fix(0.11965246577979999*ganho1) * xm2(30));
            aux2(28) = fix(xm2(28)*ganho) - (-d2(28) + fix(0.11965246577979999*ganho1) * xm2(25) + fix(0.44529883180639995*ganho1) * xm2(26) + fix(1.1139936470222562*ganho1) * xm2(27) + fix(1.5464132985428416*ganho1) * xm2(28) + fix(1.1139936470222562*ganho1) * xm2(29) + fix(0.44529883180639995*ganho1) * xm2(30) + fix(0.11965246577979999*ganho1) * xm2(31));
            aux2(29) = fix(xm2(29)*ganho) - (-d2(29) + fix(0.11965246577979999*ganho1) * xm2(26) + fix(0.44529883180639995*ganho1) * xm2(27) + fix(1.1139936470222562*ganho1) * xm2(28) + fix(1.5464132985428416*ganho1) * xm2(29) + fix(1.1139936470222562*ganho1) * xm2(30) + fix(0.44529883180639995*ganho1) * xm2(31) + fix(0.11965246577979999*ganho1) * xm2(32));
            aux2(30) = fix(xm2(30)*ganho) - (-d2(30) + fix(0.11965246577979999*ganho1) * xm2(27) + fix(0.44529883180639995*ganho1) * xm2(28) + fix(1.1139936470222562*ganho1) * xm2(29) + fix(1.5464132985428416*ganho1) * xm2(30) + fix(1.1139936470222562*ganho1) * xm2(31) + fix(0.44529883180639995*ganho1) * xm2(32) + fix(0.11965246577979999*ganho1) * xm2(33));
            aux2(31) = fix(xm2(31)*ganho) - (-d2(31) + fix(0.11965246577979999*ganho1) * xm2(28) + fix(0.44529883180639995*ganho1) * xm2(29) + fix(1.1139936470222562*ganho1) * xm2(30) + fix(1.5464132985428416*ganho1) * xm2(31) + fix(1.1139936470222562*ganho1) * xm2(32) + fix(0.44529883180639995*ganho1) * xm2(33) + fix(0.11965246577979999*ganho1) * xm2(34));
            aux2(32) = fix(xm2(32)*ganho) - (-d2(32) + fix(0.11965246577979999*ganho1) * xm2(29) + fix(0.44529883180639995*ganho1) * xm2(30) + fix(1.1139936470222562*ganho1) * xm2(31) + fix(1.5464132985428416*ganho1) * xm2(32) + fix(1.1139936470222562*ganho1) * xm2(33) + fix(0.44529883180639995*ganho1) * xm2(34) + fix(0.11965246577979999*ganho1) * xm2(35));
            aux2(33) = fix(xm2(33)*ganho) - (-d2(33) + fix(0.11965246577979999*ganho1) * xm2(30) + fix(0.44529883180639995*ganho1) * xm2(31) + fix(1.1139936470222562*ganho1) * xm2(32) + fix(1.5464132985428416*ganho1) * xm2(33) + fix(1.1139936470222562*ganho1) * xm2(34) + fix(0.44529883180639995*ganho1) * xm2(35) + fix(0.11965246577979999*ganho1) * xm2(36));
            aux2(34) = fix(xm2(34)*ganho) - (-d2(34) + fix(0.11965246577979999*ganho1) * xm2(31) + fix(0.44529883180639995*ganho1) * xm2(32) + fix(1.1139936470222562*ganho1) * xm2(33) + fix(1.5464132985428416*ganho1) * xm2(34) + fix(1.1139936470222562*ganho1) * xm2(35) + fix(0.44529883180639995*ganho1) * xm2(36) + fix(0.11965246577979999*ganho1) * xm2(37));
            aux2(35) = fix(xm2(35)*ganho) - (-d2(35) + fix(0.11965246577979999*ganho1) * xm2(32) + fix(0.44529883180639995*ganho1) * xm2(33) + fix(1.1139936470222562*ganho1) * xm2(34) + fix(1.5464132985428416*ganho1) * xm2(35) + fix(1.1139936470222562*ganho1) * xm2(36) + fix(0.44529883180639995*ganho1) * xm2(37) + fix(0.11965246577979999*ganho1) * xm2(38));
            aux2(36) = fix(xm2(36)*ganho) - (-d2(36) + fix(0.11965246577979999*ganho1) * xm2(33) + fix(0.44529883180639995*ganho1) * xm2(34) + fix(1.1139936470222562*ganho1) * xm2(35) + fix(1.5464132985428416*ganho1) * xm2(36) + fix(1.1139936470222562*ganho1) * xm2(37) + fix(0.44529883180639995*ganho1) * xm2(38) + fix(0.11965246577979999*ganho1) * xm2(39));
            aux2(37) = fix(xm2(37)*ganho) - (-d2(37) + fix(0.11965246577979999*ganho1) * xm2(34) + fix(0.44529883180639995*ganho1) * xm2(35) + fix(1.1139936470222562*ganho1) * xm2(36) + fix(1.5464132985428416*ganho1) * xm2(37) + fix(1.1139936470222562*ganho1) * xm2(38) + fix(0.44529883180639995*ganho1) * xm2(39) + fix(0.11965246577979999*ganho1) * xm2(40));
            aux2(38) = fix(xm2(38)*ganho) - (-d2(38) + fix(0.11965246577979999*ganho1) * xm2(35) + fix(0.44529883180639995*ganho1) * xm2(36) + fix(1.1139936470222562*ganho1) * xm2(37) + fix(1.5464132985428416*ganho1) * xm2(38) + fix(1.1139936470222562*ganho1) * xm2(39) + fix(0.44529883180639995*ganho1) * xm2(40) + fix(0.11965246577979999*ganho1) * xm2(41));
            aux2(39) = fix(xm2(39)*ganho) - (-d2(39) + fix(0.11965246577979999*ganho1) * xm2(36) + fix(0.44529883180639995*ganho1) * xm2(37) + fix(1.1139936470222562*ganho1) * xm2(38) + fix(1.5464132985428416*ganho1) * xm2(39) + fix(1.1139936470222562*ganho1) * xm2(40) + fix(0.44529883180639995*ganho1) * xm2(41) + fix(0.11965246577979999*ganho1) * xm2(42));
            aux2(40) = fix(xm2(40)*ganho) - (-d2(40) + fix(0.11965246577979999*ganho1) * xm2(37) + fix(0.44529883180639995*ganho1) * xm2(38) + fix(1.1139936470222562*ganho1) * xm2(39) + fix(1.5464132985428416*ganho1) * xm2(40) + fix(1.1139936470222562*ganho1) * xm2(41) + fix(0.44529883180639995*ganho1) * xm2(42) + fix(0.11965246577979999*ganho1) * xm2(43));
            aux2(41) = fix(xm2(41)*ganho) - (-d2(41) + fix(0.11965246577979999*ganho1) * xm2(38) + fix(0.44529883180639995*ganho1) * xm2(39) + fix(1.1139936470222562*ganho1) * xm2(40) + fix(1.5464132985428416*ganho1) * xm2(41) + fix(1.1139936470222562*ganho1) * xm2(42) + fix(0.44529883180639995*ganho1) * xm2(43) + fix(0.11965246577979999*ganho1) * xm2(44));
            aux2(42) = fix(xm2(42)*ganho) - (-d2(42) + fix(0.11965246577979999*ganho1) * xm2(39) + fix(0.44529883180639995*ganho1) * xm2(40) + fix(1.1139936470222562*ganho1) * xm2(41) + fix(1.5464132985428416*ganho1) * xm2(42) + fix(1.1139936470222562*ganho1) * xm2(43) + fix(0.44529883180639995*ganho1) * xm2(44) + fix(0.11965246577979999*ganho1) * xm2(45));
            aux2(43) = fix(xm2(43)*ganho) - (-d2(43) + fix(0.11965246577979999*ganho1) * xm2(40) + fix(0.44529883180639995*ganho1) * xm2(41) + fix(1.1139936470222562*ganho1) * xm2(42) + fix(1.5464132985428416*ganho1) * xm2(43) + fix(1.1139936470222562*ganho1) * xm2(44) + fix(0.44529883180639995*ganho1) * xm2(45) + fix(0.11965246577979999*ganho1) * xm2(46));
            aux2(44) = fix(xm2(44)*ganho) - (-d2(44) + fix(0.11965246577979999*ganho1) * xm2(41) + fix(0.44529883180639995*ganho1) * xm2(42) + fix(1.1139936470222562*ganho1) * xm2(43) + fix(1.5464132985428416*ganho1) * xm2(44) + fix(1.1139936470222562*ganho1) * xm2(45) + fix(0.44529883180639995*ganho1) * xm2(46) + fix(0.11965246577979999*ganho1) * xm2(47));
            aux2(45) = fix(xm2(45)*ganho) - (-d2(45) + fix(0.11965246577979999*ganho1) * xm2(42) + fix(0.44529883180639995*ganho1) * xm2(43) + fix(1.1139936470222562*ganho1) * xm2(44) + fix(1.5464132985428416*ganho1) * xm2(45) + fix(1.1139936470222562*ganho1) * xm2(46) + fix(0.44529883180639995*ganho1) * xm2(47) + fix(0.11965246577979999*ganho1) * xm2(48));
            aux2(46) = fix(xm2(46)*ganho) - (-d2(46) + fix(0.11965246577979999*ganho1) * xm2(43) + fix(0.44529883180639995*ganho1) * xm2(44) + fix(1.1139936470222562*ganho1) * xm2(45) + fix(1.5464132985428416*ganho1) * xm2(46) + fix(1.1139936470222562*ganho1) * xm2(47) + fix(0.44529883180639995*ganho1) * xm2(48));
            aux2(47) = fix(xm2(47)*ganho) - (-d2(47) + fix(0.11965246577979999*ganho1) * xm2(44) + fix(0.44529883180639995*ganho1) * xm2(45) + fix(1.1139936470222562*ganho1) * xm2(46) + fix(1.5464132985428416*ganho1) * xm2(47) + fix(1.1139936470222562*ganho1) * xm2(48));
            aux2(48) = fix(xm2(48)*ganho) - (-d2(48) + fix(0.11965246577979999*ganho1) * xm2(45) + fix(0.44529883180639995*ganho1) * xm2(46) + fix(1.1139936470222562*ganho1) * xm2(47) + fix(1.5464132985428416*ganho1) * xm2(48));
            
            aux3(1) = (xm3(1)*ganho) - (512*(-d3(1)) + 791 * xm3(1) + 570 * xm3(2) + 227 * xm3(3) + 61 * xm3(4));
            aux3(2) = (xm3(2)*ganho) - (512*(-d3(2)) + 570 * xm3(1) + 791 * xm3(2) + 570 * xm3(3) + 227 * xm3(4) + 61 * xm3(5));
            aux3(3) = (xm3(3)*ganho) - (512*(-d3(3)) + 227 * xm3(1) + 570 * xm3(2) + 791 * xm3(3) + 570 * xm3(4) + 227 * xm3(5) + 61 * xm3(6));
            aux3(4) = (xm3(4)*ganho) - (512*(-d3(4)) + 61 * xm3(1) + 227 * xm3(2) + 570 * xm3(3) + 791 * xm3(4) + 570 * xm3(5) + 227 * xm3(6) + 61 * xm3(7));
            aux3(5) = (xm3(5)*ganho) - (512*(-d3(5)) + 61 * xm3(2) + 227 * xm3(3) + 570 * xm3(4) + 791 * xm3(5) + 570 * xm3(6) + 227 * xm3(7) + 61 * xm3(8));
            aux3(6) = (xm3(6)*ganho) - (512*(-d3(6)) + 61 * xm3(3) + 227 * xm3(4) + 570 * xm3(5) + 791 * xm3(6) + 570 * xm3(7) + 227 * xm3(8) + 61 * xm3(9));
            aux3(7) = (xm3(7)*ganho) - (512*(-d3(7)) + 61 * xm3(4) + 227 * xm3(5) + 570 * xm3(6) + 791 * xm3(7) + 570 * xm3(8) + 227 * xm3(9) + 61 * xm3(10));
            aux3(8) = (xm3(8)*ganho) - (512*(-d3(8)) + 61 * xm3(5) + 227 * xm3(6) + 570 * xm3(7) + 791 * xm3(8) + 570 * xm3(9) + 227 * xm3(10) + 61 * xm3(11));
            aux3(9) = (xm3(9)*ganho) - (512*(-d3(9)) + 61 * xm3(6) + 227 * xm3(7) + 570 * xm3(8) + 791 * xm3(9) + 570 * xm3(10) + 227 * xm3(11) + 61 * xm3(12));
            aux3(10) = (xm3(10)*ganho) - (512*(-d3(10)) + 61 * xm3(7) + 227 * xm3(8) + 570 * xm3(9) + 791 * xm3(10) + 570 * xm3(11) + 227 * xm3(12) + 61 * xm3(13));
            aux3(11) = (xm3(11)*ganho) - (512*(-d3(11)) + 61 * xm3(8) + 227 * xm3(9) + 570 * xm3(10) + 791 * xm3(11) + 570 * xm3(12) + 227 * xm3(13) + 61 * xm3(14));
            aux3(12) = (xm3(12)*ganho) - (512*(-d3(12)) + 61 * xm3(9) + 227 * xm3(10) + 570 * xm3(11) + 791 * xm3(12) + 570 * xm3(13) + 227 * xm3(14) + 61 * xm3(15));
            aux3(13) = (xm3(13)*ganho) - (512*(-d3(13)) + 61 * xm3(10) + 227 * xm3(11) + 570 * xm3(12) + 791 * xm3(13) + 570 * xm3(14) + 227 * xm3(15) + 61 * xm3(16));
            aux3(14) = (xm3(14)*ganho) - (512*(-d3(14)) + 61 * xm3(11) + 227 * xm3(12) + 570 * xm3(13) + 791 * xm3(14) + 570 * xm3(15) + 227 * xm3(16) + 61 * xm3(17));
            aux3(15) = (xm3(15)*ganho) - (512*(-d3(15)) + 61 * xm3(12) + 227 * xm3(13) + 570 * xm3(14) + 791 * xm3(15) + 570 * xm3(16) + 227 * xm3(17) + 61 * xm3(18));
            aux3(16) = (xm3(16)*ganho) - (512*(-d3(16)) + 61 * xm3(13) + 227 * xm3(14) + 570 * xm3(15) + 791 * xm3(16) + 570 * xm3(17) + 227 * xm3(18) + 61 * xm3(19));
            aux3(17) = (xm3(17)*ganho) - (512*(-d3(17)) + 61 * xm3(14) + 227 * xm3(15) + 570 * xm3(16) + 791 * xm3(17) + 570 * xm3(18) + 227 * xm3(19) + 61 * xm3(20));
            aux3(18) = (xm3(18)*ganho) - (512*(-d3(18)) + 61 * xm3(15) + 227 * xm3(16) + 570 * xm3(17) + 791 * xm3(18) + 570 * xm3(19) + 227 * xm3(20) + 61 * xm3(21));
            aux3(19) = (xm3(19)*ganho) - (512*(-d3(19)) + 61 * xm3(16) + 227 * xm3(17) + 570 * xm3(18) + 791 * xm3(19) + 570 * xm3(20) + 227 * xm3(21) + 61 * xm3(22));
            aux3(20) = (xm3(20)*ganho) - (512*(-d3(20)) + 61 * xm3(17) + 227 * xm3(18) + 570 * xm3(19) + 791 * xm3(20) + 570 * xm3(21) + 227 * xm3(22) + 61 * xm3(23));
            aux3(21) = (xm3(21)*ganho) - (512*(-d3(21)) + 61 * xm3(18) + 227 * xm3(19) + 570 * xm3(20) + 791 * xm3(21) + 570 * xm3(22) + 227 * xm3(23) + 61 * xm3(24));
            aux3(22) = (xm3(22)*ganho) - (512*(-d3(22)) + 61 * xm3(19) + 227 * xm3(20) + 570 * xm3(21) + 791 * xm3(22) + 570 * xm3(23) + 227 * xm3(24) + 61 * xm3(25));
            aux3(23) = (xm3(23)*ganho) - (512*(-d3(23)) + 61 * xm3(20) + 227 * xm3(21) + 570 * xm3(22) + 791 * xm3(23) + 570 * xm3(24) + 227 * xm3(25) + 61 * xm3(26));
            aux3(24) = (xm3(24)*ganho) - (512*(-d3(24)) + 61 * xm3(21) + 227 * xm3(22) + 570 * xm3(23) + 791 * xm3(24) + 570 * xm3(25) + 227 * xm3(26) + 61 * xm3(27));
            aux3(25) = (xm3(25)*ganho) - (512*(-d3(25)) + 61 * xm3(22) + 227 * xm3(23) + 570 * xm3(24) + 791 * xm3(25) + 570 * xm3(26) + 227 * xm3(27) + 61 * xm3(28));
            aux3(26) = (xm3(26)*ganho) - (512*(-d3(26)) + 61 * xm3(23) + 227 * xm3(24) + 570 * xm3(25) + 791 * xm3(26) + 570 * xm3(27) + 227 * xm3(28) + 61 * xm3(29));
            aux3(27) = (xm3(27)*ganho) - (512*(-d3(27)) + 61 * xm3(24) + 227 * xm3(25) + 570 * xm3(26) + 791 * xm3(27) + 570 * xm3(28) + 227 * xm3(29) + 61 * xm3(30));
            aux3(28) = (xm3(28)*ganho) - (512*(-d3(28)) + 61 * xm3(25) + 227 * xm3(26) + 570 * xm3(27) + 791 * xm3(28) + 570 * xm3(29) + 227 * xm3(30) + 61 * xm3(31));
            aux3(29) = (xm3(29)*ganho) - (512*(-d3(29)) + 61 * xm3(26) + 227 * xm3(27) + 570 * xm3(28) + 791 * xm3(29) + 570 * xm3(30) + 227 * xm3(31) + 61 * xm3(32));
            aux3(30) = (xm3(30)*ganho) - (512*(-d3(30)) + 61 * xm3(27) + 227 * xm3(28) + 570 * xm3(29) + 791 * xm3(30) + 570 * xm3(31) + 227 * xm3(32) + 61 * xm3(33));
            aux3(31) = (xm3(31)*ganho) - (512*(-d3(31)) + 61 * xm3(28) + 227 * xm3(29) + 570 * xm3(30) + 791 * xm3(31) + 570 * xm3(32) + 227 * xm3(33) + 61 * xm3(34));
            aux3(32) = (xm3(32)*ganho) - (512*(-d3(32)) + 61 * xm3(29) + 227 * xm3(30) + 570 * xm3(31) + 791 * xm3(32) + 570 * xm3(33) + 227 * xm3(34) + 61 * xm3(35));
            aux3(33) = (xm3(33)*ganho) - (512*(-d3(33)) + 61 * xm3(30) + 227 * xm3(31) + 570 * xm3(32) + 791 * xm3(33) + 570 * xm3(34) + 227 * xm3(35) + 61 * xm3(36));
            aux3(34) = (xm3(34)*ganho) - (512*(-d3(34)) + 61 * xm3(31) + 227 * xm3(32) + 570 * xm3(33) + 791 * xm3(34) + 570 * xm3(35) + 227 * xm3(36) + 61 * xm3(37));
            aux3(35) = (xm3(35)*ganho) - (512*(-d3(35)) + 61 * xm3(32) + 227 * xm3(33) + 570 * xm3(34) + 791 * xm3(35) + 570 * xm3(36) + 227 * xm3(37) + 61 * xm3(38));
            aux3(36) = (xm3(36)*ganho) - (512*(-d3(36)) + 61 * xm3(33) + 227 * xm3(34) + 570 * xm3(35) + 791 * xm3(36) + 570 * xm3(37) + 227 * xm3(38) + 61 * xm3(39));
            aux3(37) = (xm3(37)*ganho) - (512*(-d3(37)) + 61 * xm3(34) + 227 * xm3(35) + 570 * xm3(36) + 791 * xm3(37) + 570 * xm3(38) + 227 * xm3(39) + 61 * xm3(40));
            aux3(38) = (xm3(38)*ganho) - (512*(-d3(38)) + 61 * xm3(35) + 227 * xm3(36) + 570 * xm3(37) + 791 * xm3(38) + 570 * xm3(39) + 227 * xm3(40) + 61 * xm3(41));
            aux3(39) = (xm3(39)*ganho) - (512*(-d3(39)) + 61 * xm3(36) + 227 * xm3(37) + 570 * xm3(38) + 791 * xm3(39) + 570 * xm3(40) + 227 * xm3(41) + 61 * xm3(42));
            aux3(40) = (xm3(40)*ganho) - (512*(-d3(40)) + 61 * xm3(37) + 227 * xm3(38) + 570 * xm3(39) + 791 * xm3(40) + 570 * xm3(41) + 227 * xm3(42) + 61 * xm3(43));
            aux3(41) = (xm3(41)*ganho) - (512*(-d3(41)) + 61 * xm3(38) + 227 * xm3(39) + 570 * xm3(40) + 791 * xm3(41) + 570 * xm3(42) + 227 * xm3(43) + 61 * xm3(44));
            aux3(42) = (xm3(42)*ganho) - (512*(-d3(42)) + 61 * xm3(39) + 227 * xm3(40) + 570 * xm3(41) + 791 * xm3(42) + 570 * xm3(43) + 227 * xm3(44) + 61 * xm3(45));
            aux3(43) = (xm3(43)*ganho) - (512*(-d3(43)) + 61 * xm3(40) + 227 * xm3(41) + 570 * xm3(42) + 791 * xm3(43) + 570 * xm3(44) + 227 * xm3(45) + 61 * xm3(46));
            aux3(44) = (xm3(44)*ganho) - (512*(-d3(44)) + 61 * xm3(41) + 227 * xm3(42) + 570 * xm3(43) + 791 * xm3(44) + 570 * xm3(45) + 227 * xm3(46) + 61 * xm3(47));
            aux3(45) = (xm3(45)*ganho) - (512*(-d3(45)) + 61 * xm3(42) + 227 * xm3(43) + 570 * xm3(44) + 791 * xm3(45) + 570 * xm3(46) + 227 * xm3(47) + 61 * xm3(48));
            aux3(46) = (xm3(46)*ganho) - (512*(-d3(46)) + 61 * xm3(43) + 227 * xm3(44) + 570 * xm3(45) + 791 * xm3(46) + 570 * xm3(47) + 227 * xm3(48));
            aux3(47) = (xm3(47)*ganho) - (512*(-d3(47)) + 61 * xm3(44) + 227 * xm3(45) + 570 * xm3(46) + 791 * xm3(47) + 570 * xm3(48));
            aux3(48) = (xm3(48)*ganho) - (512*(-d3(48)) + 61 * xm3(45) + 227 * xm3(46) + 570 * xm3(47) + 791 * xm3(48));
            
            
            aux2 = fix(aux2);
%%%%%%%%%%%%%%%%%%%%%%%%% AGORA AUX TEM GANHO = ganho^3 %%%%%%%%%%%%%%%
            
 for i=1:1:48
       d1(i)= d1(i)*4;
       d2(i) = d2(i)*4;
       d2(i) = fix(d2(i));
 end
d3(1) = d3(1)*ganho;
d3(2) = d3(2)*ganho;
d3(3) = d3(3)*ganho;
d3(4) = d3(4)*ganho;
d3(5) = d3(5)*ganho;
d3(6) = d3(6)*ganho;
d3(7) = d3(7)*ganho;
d3(8) = d3(8)*ganho;
d3(9) = d3(9)*ganho;
d3(10) = d3(10)*ganho;
d3(11) = d3(11)*ganho;
d3(12) = d3(12)*ganho;
d3(13) = d3(13)*ganho;
d3(14) = d3(14)*ganho;
d3(15) = d3(15)*ganho;
d3(16) = d3(16)*ganho;
d3(17) = d3(17)*ganho;
d3(18) = d3(18)*ganho;
d3(19) = d3(19)*ganho;
d3(20) = d3(20)*ganho;
d3(21) = d3(21)*ganho;
d3(22) = d3(22)*ganho;
d3(23) = d3(23)*ganho;
d3(24) = d3(24)*ganho;
d3(25) = d3(25)*ganho;
d3(26) = d3(26)*ganho;
d3(27) = d3(27)*ganho;
d3(28) = d3(28)*ganho;
d3(29) = d3(29)*ganho;
d3(30) = d3(30)*ganho;
d3(31) = d3(31)*ganho;
d3(32) = d3(32)*ganho;
d3(33) = d3(33)*ganho;
d3(34) = d3(34)*ganho;
d3(35) = d3(35)*ganho;
d3(36) = d3(36)*ganho;
d3(37) = d3(37)*ganho;
d3(38) = d3(38)*ganho;
d3(39) = d3(39)*ganho;
d3(40) = d3(40)*ganho;
d3(41) = d3(41)*ganho;
d3(42) = d3(42)*ganho;
d3(43) = d3(43)*ganho;
d3(44) = d3(44)*ganho;
d3(45) = d3(45)*ganho;
d3(46) = d3(46)*ganho;
d3(47) = d3(47)*ganho;
d3(48) = d3(48)*ganho;


           for i=1:1:48
           if aux(i) < 0
              xm(i) = 0;
           else
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% XM RECEBE AUX %%%%%%%%%%%%%%%%%%%%%%%%
                xm(i) = aux(i);
           end
           if aux2(i) < 0
               xm2(i) = 0;
           else
               xm2(i) = aux2(i);
           end
           if aux3(i) < 0
               xm3(i) = 0;
           else
               xm3(i) = aux3(i);
           end
           end
     
        end
        
    xm2 = fix(xm2);
%%%%%%%%%%%%%%%%%%%%%% AGORA XM TEM GANHO = ganho^3 %%%%%%%%%%%%%%%%%%%

        signalxm(52:55) = 0;
        signalxm2(52:55) = 0;
        signalxm3(52:55) = 0;
        signalxm(pass+Ad:pass+window-Ae-1) = xm;
        signalxm2(pass+Ad:pass+window-Ae-1) = xm2;
        signalxm3(pass+Ad:pass+window-Ae-1) = xm3;
        

    end

%%%%%%% MULTIPLICANDO signalT POR ganho^3 PARA ENCONTRAR O ERRO %%%%%%%   
    rmsxm = eqm(signalT(1:55)*ganho^3-signalxm);
    rmsxm2 = eqm(signalT(1:55)*ganho^3-signalxm2);
    rmsxm3 = eqm(signalT(1:55)*ganho^3-signalxm3);

    graficoxm3(it) = rmsxm3/ganho^3;
    graficoxm2(it) = rmsxm2/ganho^3;
    graficoxm(it) = rmsxm/ganho^3;

%%%%%%%%%%%%%%%%%% DIVIDINDO XM E D1 PELO GANHO %%%%%%%%%%%%%%%%%%%%%%%    
    for i=1:1:48
      xm(i)= xm(i)/ganho;
      d1(i)= d1(i)/ganho;
      xm2(i)= xm2(i)/ganho;
      d2(i)= d2(i)/ganho;
      xm3(i)= xm3(i)/ganho;
      d3(i)= d3(i)/ganho;
    end
    
    xm2= fix(xm2);
    d2 = fix(d2);
%%%%%%%%%%%%%%%%%%%%%% AGORA XM TEM GANHO = ganho^2 %%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%% AGORA D1 TEM GANHO = ganho^2 %%%%%%%%%%%%%%%%%%%
    fprintf('Iteration %d RMS between Truth and (Float = %f)\n', it, rmsxm);
end

figure (4)
plot(graficoxm)
hold on
plot(graficoxm2)
%hold on
%plot(graficoxm3)

legend('Sem Ganho','Com Ganho e Truncado')

figure
bar3(A);
title('Coeficientes da Matriz A');
grid on
